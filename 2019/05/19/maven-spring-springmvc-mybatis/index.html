<!DOCTYPE html>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>
    Maven+Spring+SpringMVC+MyBatis整合 | TEAPER
  </title>
  <meta name="description" content="与人为善是修养，独来独往是性格！">
  
  <meta name="keywords" content="
  java,Maven,Tomcat,Spring,SpringMVC,MyBatis,MySQL
  ">
  
  <meta name="author" content="teaper">

  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="theme-color" content="#1e2327">
  <link rel="apple-touch-icon" href="https://github.githubassets.com/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://github.githubassets.com/apple-touch-icon-180x180.png">

  <link rel="icon" type="image/x-icon" href="https://i.loli.net/2019/06/04/5cf683cea837456459.jpeg">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/live2d/css/live2d.css">
  <link rel="stylesheet" href="/css/player.css">
  <link rel="stylesheet" href="/iconfont/iconfont.css">
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-140493383-1', 'auto');
  ga('send', 'pageview');
</script>


  

  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.25-csp/vue.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
</head>

<body id="replica-app">

<nav class="navbar-wrapper">
  <div class="navbar">
    <div class="container clearfix">
      <a href="/" class="navbar-logo"><i class="fa fa-github"></i></a>

      <div class="navbar-search float-left desktop-only">
        <!-- <div class="navbar-search-form">
          <label for="gsc-i-id1">This website</label>
          <div id="google-search">
            <gcse:search></gcse:search>
          </div>
        </div> -->

		<div class="navbar-search-form">
		  <label for="gsc-i-id1">THIS WEBSITE</label>
          <div id="site_search">
        	<input type="text" id="local-search-input" style results="0">
          </div>
        </div>
		
      </div>

      <ul class="navbar-nav float-left">
        
        <li><a href="/archives">Archives</a></li>
        
        
        <li><a href="/categories">Categories</a></li>
        
        
        <li><a href="/tags">Tags</a></li>
        
        
        <li><a href="/links">Links</a></li>
        
		
        <li><a href="/files">Files</a></li>
        
        
        <li class="desktop-only"><a href="/atom.xml" target="_blank">RSS</a></li>
        
      </ul>

      <ul class="navbar-nav user-nav float-right desktop-only">
        <li class="user-nav-notification">
          <a><span class="user-nav-unread"></span><i class="fa fa-bell"></i></a>
        </li>
        <li>
          <a><i class="fa fa-plus"></i> <i class="fa fa-caret-down"></i></a>
        </li>
        <li class="user-nav-logo">
          <a><img src="https://i.loli.net/2019/06/04/5cf683cea837456459.jpeg"> <i class="fa fa-caret-down"></i></a>
        </li>
      </ul>
	  <!-- 站内搜索结果 -->
	  <br>
      <div id="local-search-result"></div>

    </div>
  </div>
</nav>

<div class="main-container">
  <header class="header-wrapper desktop-only">
  <div class="container header-site-detail">
    <ul class="header-toolbar">
      <li class="clearfix">
        <a href="/archives" class="header-toolbar-left"><i class="fa fa-file-text"></i> Posts </a>
        <a href="/archives" class="header-toolbar-right"> 21 </a>
      </li>
      <li>
        <a href="/tags" class="header-toolbar-left"><i class="fa fa-tags"></i> Tags </a>
        <a href="/tags" class="header-toolbar-right"> 52 </a>
      </li>
      <li>
        <a href="/categories" class="header-toolbar-left"><i class="fa fa-folder-open"></i> Categories </a>
        <a href="/categories" class="header-toolbar-right"> 11 </a>
      </li>
    </ul>
    <h2 class="header-title">
      <i class="fa fa-book text-muted"></i>
      <a href="/">TEAPER</a>
      
      
    </h2>
  </div>

  <div class="container">
    <div class="header-tab-wrapper clearfix">
      <span class="header-tab header-tab-selected"><i class="fa fa-thumbs-o-up"></i> Like</span>
      <span class="header-tab"><i class="fa fa-share-alt"></i> Share</span>
      <span class="header-tab"><i class="fa fa-comments-o"></i> Discussion</span>
      <span class="header-tab"><i class="fa fa-bookmark-o"></i> Bookmark </span>
      <span class="header-tab"><i class="fa fa-smile-o"></i> Smile <i class="fa fa-caret-down"></i></span>
    </div>
  </div>
</header>


<div class="post-container container">
  <h3>
    <i class="fa fa-user-o"></i>
    teaper

    <span class="post-date float-right" title="{{moment(1558276039000).format('MMM DD, YYYY, h:mm:ss A')}}">
      <i class="fa fa-pencil-square-o"></i>
      {{moment(1558276039000).fromNow()}}
    </span>
  </h3>

  <article class="post-content">
    <h1 style="text-align:center">Maven+Spring+SpringMVC+MyBatis整合</h1>
    <h3 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h3><h4 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境:"></a>开发环境:</h4><p>系统：Arch Linux<br>JDK-1.8<br>Eclipse-4.10<br>Tomcat-9.0<br>浏览器：Chrome   </p>
<h4 id="技术"><a href="#技术" class="headerlink" title="技术:"></a>技术:</h4><p>项目管理：Maven-3.6.0<br>动态Web模块：Dynamic Web Module-4.0<br>基础框架：Spring+SpringMVC+MyBatis<br>数据库：10.1.37-MariaDB（ArchLinux下的MySQL）<br>前端框架：bootstrap-3.3.7+jquery-3.3.1.min.js<br>分页：pagehelper<br>逆向工程：MyBatis Generator   </p>
<h4 id="功能"><a href="#功能" class="headerlink" title="功能:"></a>功能:</h4><p>分页查询<br>数据校验(前端:jquery校验+后端:JSR303校验)<br>ajax请求<br>Rest风格的URI   </p>
<h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构:"></a>目录结构:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Project Explorer视图下</span></span><br><span class="line">|ssm </span><br><span class="line">|---src/main/java</span><br><span class="line">|	|---cn.teaper.www   <span class="comment">//包路径</span></span><br><span class="line">|		|---controller      <span class="comment">//控制器</span></span><br><span class="line">|		|---dao         <span class="comment">//数据库dao</span></span><br><span class="line">|		|---pojo        <span class="comment">//实体类</span></span><br><span class="line">|		|---service     <span class="comment">//服务层</span></span><br><span class="line">|		|---test        <span class="comment">//测试类</span></span><br><span class="line">|		|---tools        <span class="comment">//工具类</span></span><br><span class="line">|---src/main/resources</span><br><span class="line">|	|---mapper      <span class="comment">//存放mapper文件</span></span><br><span class="line">|	|---applicationContext.xml      <span class="comment">//Spring核心配置文件</span></span><br><span class="line">|	|---database.properties     <span class="comment">//数据库连接信息</span></span><br><span class="line">|	|---mybatis-config.xml      <span class="comment">//</span></span><br><span class="line">|	|---spring-mvc.xml          <span class="comment">//</span></span><br><span class="line">|---src/test/java       <span class="comment">//手动创建(可选)</span></span><br><span class="line">|---src/test/resources      <span class="comment">//手动创建(可选)</span></span><br><span class="line">|---JRE System Library[JavaSE-<span class="number">1.8</span>]</span><br><span class="line">|---Maven Dependencies</span><br><span class="line">|---src</span><br><span class="line">|   |---main</span><br><span class="line">|       |---webapp</span><br><span class="line">|           |---META-INF</span><br><span class="line">|           |---<span class="keyword">static</span>  <span class="comment">//手动创建</span></span><br><span class="line">|               |---bootstrap-<span class="number">3.3</span>.7.dist    </span><br><span class="line">|           |---WEB-INF     <span class="comment">//重新生成</span></span><br><span class="line">|               |---lib</span><br><span class="line">|               |---views       <span class="comment">//手动创建，用于存放视图文件</span></span><br><span class="line">|           |---index.jsp   <span class="comment">//重新创建</span></span><br><span class="line">|---target</span><br><span class="line">|---mbg.xml</span><br><span class="line">|---pom.xml</span><br><span class="line">|---ssm.sql     <span class="comment">//数据库SQL文件</span></span><br><span class="line">|---doc         <span class="comment">//项目文档(gitbook)</span></span><br></pre></td></tr></table></figure>

<h3 id="项目环境搭建"><a href="#项目环境搭建" class="headerlink" title="项目环境搭建"></a>项目环境搭建</h3><h4 id="创建Maven工程"><a href="#创建Maven工程" class="headerlink" title="创建Maven工程:"></a>创建Maven工程:</h4><p>单击 File -&gt; New -&gt; Maven Projct   </p>
<p>勾选 <code>Use defaut Workspace location</code> 复选框,<code>Browse..</code>项目存放位置,单击 <code>Next</code><br>选则相应模板 <code>org.apache.maven.archetypes maven-archetype-webapp 1.0</code><br>单击 <code>Next</code>,输入基本信息:  </p>
<blockquote>
<p>Group Id：组名字（例如：cn.teaper）<br>Artifact Id：项目名称（例如：ssm）<br>Version：版本号,默认0.0.1-SNAPSHOT<br>Packing：项目包结构（例如：cn.teaper.www）  </p>
</blockquote>
<p>单击 <code>Finish</code> 完成  </p>
<p>把<code>src/main/webapp</code>下默认的文件和文件夹删除  </p>
<p>右击项目 -&gt; Properties -&gt; Project Facets 中修改 Java 版本为 1.8,取消勾选 <code>Dynamic Web Module(2.3)</code>，选择4.0，保存一下，再重新勾选，单击下方 <code>further configruation available</code>,输入<code>Content directory</code> 地址为 <code>src/main/webapp</code> ，勾选 <code>Generate~</code> 复选框，再保存一下;<br>web.xml内容为以下样式即可：  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.htm<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.htm<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>default.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>选择 <code>Java Build Path</code> ，在 Source 窗口下置输出路径 output folder ，确保每个文件夹都输出在 <code>*/target/classes</code> 目录中;选择 <code>Deployment Assembly</code> , Remove 掉不需要的设置 <code>(src/test/*)</code><br><span style="color:#ff0000;">注意:如果<code>Project Facets</code>中无法修改版本信息，就在 <code>Navigator</code> 视图中编辑<code>org.eclipse.wst.common.project.facet.core.xml</code>文件，<code>Navigator</code> 视图在 windows &gt; show viwe 中找</span>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">faceted-project</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">fixed</span> <span class="attr">facet</span>=<span class="string">"wst.jsdt.web"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">installed</span> <span class="attr">facet</span>=<span class="string">"java"</span> <span class="attr">version</span>=<span class="string">"1.8"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">installed</span> <span class="attr">facet</span>=<span class="string">"jst.web"</span> <span class="attr">version</span>=<span class="string">"3.1"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">installed</span> <span class="attr">facet</span>=<span class="string">"wst.jsdt.web"</span> <span class="attr">version</span>=<span class="string">"1.0"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">faceted-project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果 src/main/java、src/test/java、src/test/resources 目录不存在；则在 Navigator 视图中手动创建上面三个文件夹( Navigator 视图在 windows -&gt; show view 中打开)<br>最终目录结构如上图所示  </p>
<h4 id="引入jar包"><a href="#引入jar包" class="headerlink" title="引入jar包:"></a>引入jar包:</h4><p>打开 pom.xml, 把<a href="https://mvnrepository.com/" rel="external nofollow noopener noreferrer" target="_blank">maven仓库</a>中的 dependency 信息粘贴到 pom.xml 的 dependencies 标签中，每个模块的 dependency 和它所包含的 jar 包如下  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">SpringMVC模块:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">spring-webmvc-4.3.7.RELEASE.jar</span><br><span class="line">spring-aop-4.3.7.RELEASE.jar</span><br><span class="line">spring-beans-4.3.7.RELEASE.jar</span><br><span class="line">spring-context-4.3.7.RELEASE.jar</span><br><span class="line">spring-core-4.3.7.RELEASE.jar</span><br><span class="line">commons-logging-1.2.jar</span><br><span class="line">spring-expression-4.3.7.RELEASE.jar</span><br><span class="line">spring-web-4.3.7.RELEASE.jar</span><br><span class="line"></span><br><span class="line">Spring-jdbc模块:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">spring-jdbc-4.3.7.RELEASE.jar</span><br><span class="line">spring-beans-4.3.7.RELEASE.jar</span><br><span class="line">spring-core-4.3.7.RELEASE.jar</span><br><span class="line">commons-logging-1.2.jar</span><br><span class="line">spring-tx-4.3.7.RELEASE.jar</span><br><span class="line"></span><br><span class="line">Spring面向切面编程:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">spring-aspects-4.3.7.RELEASE.jar</span><br><span class="line">aspectjweaver-1.8.9.jar </span><br><span class="line"></span><br><span class="line">Spring单元测试模块:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.3.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">spring-test-4.3.7.RELEASE.jar</span><br><span class="line"></span><br><span class="line">mybatis模块:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">mybatis-3.4.2.jar</span><br><span class="line"></span><br><span class="line">mybatis逆向工程:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">mybatis-generator-core-1.3.5.jar</span><br><span class="line"></span><br><span class="line">引入pagehelper分页插件: </span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">pagehelper-5.1.2.jar</span><br><span class="line">jsqlparser-1.0.jar </span><br><span class="line"></span><br><span class="line">controller返回JSON字符串的支持:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">jackson-databind-2.9.6.jar </span><br><span class="line">jackson-annotations-2.9.0.jar</span><br><span class="line">jackson-core-2.9.6.jar</span><br><span class="line">	</span><br><span class="line">mybatis整合spring的适配包:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">mybatis-spring-1.3.1.jar</span><br><span class="line"></span><br><span class="line">数据库连接池mysql驱动:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.41<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>		</span><br><span class="line"></span><br><span class="line">c3p0-0.9.1.2.jar</span><br><span class="line">mysql-connector-java-5.1.41.jar</span><br><span class="line"></span><br><span class="line">其他:</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">jstl-1.2.jar</span><br><span class="line">javax.servlet-api-3.1.0.jar</span><br><span class="line">juint4.12.jar </span><br><span class="line">jackson-databind-2.9.6.jar 返回JSON字符串的支持</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.4.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">hibernate-validator-5.2.4.Final.jar     JSR303后端校验</span><br><span class="line">validation-api-1.1.0.Final.jar      validation验证注解</span><br><span class="line">jboss-logging-3.2.1.Final.jar</span><br><span class="line">classmate-1.1.0.jar</span><br></pre></td></tr></table></figure>


<h4 id="引入Bootstrap前端框架"><a href="#引入Bootstrap前端框架" class="headerlink" title="引入Bootstrap前端框架"></a>引入Bootstrap前端框架</h4><p>下载用于生产环境的<a href="https://getbootstrap.com/docs/3.3/" rel="external nofollow noopener noreferrer" target="_blank">Bootstrap</a>,解压后得到bootstrap-3.3.7-dist文件夹，使用方法参考<a href="https://v3.bootcss.com/getting-started/#template" rel="external nofollow noopener noreferrer" target="_blank">官方文档</a><br>在项目的webapp目录下新建static文件夹,将bootstrap-3.3.7-dist文件夹放置在它下面，在static文件夹下新建css、js、img文件夹，用于存放其他网页文件<br>下载<a href="http://jquery.com/" rel="external nofollow noopener noreferrer" target="_blank">jquery</a>,将其解压得到的jquery-3.3.1.min.js放置在static/js文件夹中<br>在webapp目录下新建index.jsp，在head标签中引入，注意jquery需要在最上面  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入jquery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"static/js/jquery-3.3.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入bootstrop样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h4 id="编写SSM整合的XML文件"><a href="#编写SSM整合的XML文件" class="headerlink" title="编写SSM整合的XML文件"></a>编写SSM整合的XML文件</h4><h5 id="编写web-xml"><a href="#编写web-xml" class="headerlink" title="编写web.xml"></a>编写web.xml</h5><p>让项目启动时就启动<strong>Spring容器</strong>，这时候就需要一个<code>contextConfigLocation</code>(使用快捷键<code>Alt+/</code>根据提示生成)，classpath指定配置文件路径  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- needed for ContextLoaderListener --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Bootstraps the root web application context before servlet initialization --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>这时候需要在src/main/resources创建出applicationContext.xml，如果我们没有模板  </p>
<blockquote>
<p>需要先查看Eclipse的版本号：Help -&gt;About Eclipse<br>再去Spring<a href="http://spring.io/tools/sts/all" rel="external nofollow noopener noreferrer" target="_blank">插件官网</a>复制与Eclipse版本相对应的Update Sites<br>网址<br>在Eclipse的Help -&gt; Install New Software..中Add的Work  with地址，名字随便，地址填写上面复制的Update Sites网址<br>勾选四个带/Spring IDE的复选框,finsh完成,静待安装完成,重启Eclipse  </p>
</blockquote>
<p>创建applicationContext.xml可以右击选择New -&gt; Other -&gt; Spring Bean Configuration File;创建完回到web.xml继续进行配置  </p>
<p>配置<strong>SpringMVC的前端控制器</strong>,用于拦截所有请求,classpath指定SpringMVC配置文件路径，由于我的spring-mvc.xml在src/main/resources下，所以需要指定，如果不想使用init-param标签指定配置文件路径，则需要在web.xml的同级别目录(例如：webapp)下创建一个和<code>org.springframework.web.servlet.DispatcherServlet</code>同名的<code>springDispatcherServlet-servlet.xml</code>；需要拦截所有请求,把url-pattern设置为<code>/</code>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The front controller of this Spring Web application, responsible for handling all application requests --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Map all requests to the DispatcherServlet for handling --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springDispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们也先在src/main/resources创建Spring Bean Configuration File文件spring-mvc.xml  </p>
<p>配完SpringMVC，那么顺便把它所带的<strong>字符编码过滤器</strong>也一并配置了，init-param在初始化响应的时候指定encoding类型为utf-8，默认是false，在Spring3.0版本只有一个forceEncoding，由于我们用的4.3版本，需要配置forceRequestEncoding和forceReponseEncoding；/*拦截所有请求  </p>
<blockquote>
<p><code>&lt;filter-class&gt;</code>路径可以通过<code>Ctrl+Shift+T</code>查找<code>CharacterEncodingFilter</code>获得相关类信息   </p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">   		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceReponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &lt;init-param&gt;</span></span><br><span class="line"><span class="comment">		&lt;param-name&gt;forceEncoding&lt;/param-name&gt;</span></span><br><span class="line"><span class="comment">   		&lt;param-value&gt;true&lt;/param-value&gt;</span></span><br><span class="line"><span class="comment">	&lt;/init-param&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>因为我们要使用REST风格的URI,将页面普通的post请求转为指定的delete或者put请求，所以还需要一个过滤器<br><span style="color:red;">注意:当我们有多个过滤器的时候，字符编码过滤器一定要在所有过滤器之前</span></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 4、使用REST风格的URI，将页面普通的post请求转为指定的delete或者put请求 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- REST风格的PUT请求转换过滤器(可选) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h5 id="编写spring-mvc-xml"><a href="#编写spring-mvc-xml" class="headerlink" title="编写spring-mvc.xml"></a>编写spring-mvc.xml</h5><p>SpringMVC的配置文件主要负责网站的跳转逻辑配置<br>打开spring-mvc.xml，在下方的Namespace视图下，勾选beans、context、mvc组件，回到Source视图<br>我们需要扫描所有包，首先，在src/main/java下创建目录结构，结构如上图所示，包括dao、controller、pojo、service、test、tool等<br>由于她是SpringMVC组件，我们不需要它扫描所有包，只需要扫描控制器Controller，所以通过<code>&lt;context:include-filter/&gt;</code>指定，所有带@Controller注解的就会被标识为控制器，被扫描进去<br>使用<code>use-default-filters=&quot;false&quot;</code>禁用默认扫描规则(默认扫描全部，包括@Controller)  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.teaper.www"</span> <span class="attr">use-default-filters</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>配置图解析器，方便页面返回，这里我们把所有JSP文件存放在/WEB-INF/views/文件夹下，这里需要手动创建文件夹views<br>prefix指定视图文件所在路径，路径结尾必须有<code>/</code><br>suffix指定视图文件是以.jsp为后缀的文件  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/views/"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>解析器配置完还需要<strong>俩个标准</strong>配置<br><code>default-servlet-handler</code>将spring不能处理的请求交给tomcat；它会像一个检查员，对进入<code>springDispatcherServlet</code>的URI进行筛查，如果发现是静态资源的请求，就将该请求转由Web应用服务器默认的Servlet处理，如果不是静态资源的请求，才由DispatcherServlet继续处理<br><code>annotation-driven</code>能支持Springmvc更高级的一些功能,例如:JSR303校验，ajax的映射动态请求   </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure>


<h5 id="编写applicationContext-xml"><a href="#编写applicationContext-xml" class="headerlink" title="编写applicationContext.xml"></a>编写applicationContext.xml</h5><p>applicationContext.xml是Spring的核心配置文件，主要配置和业务逻辑有关系的，例如数据源，事务控制等<br>打开applicationContext.xml，在下方的Namespace视图下，勾选aop、beans、context、tx组件，回到Source视图<br>配置<strong>数据源</strong>，我们用的是c3p0，数据库连接信息来自于properties文件，所以我们需要在src/main/resources下创建database.properties，为了和其他配置信息区别开来，我们加上<code>jdbc.</code>前缀，结果如下  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://127.0.0.1:3306/ssm?useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">jdbc.user=root</span><br><span class="line">jdbc.password=123</span><br></pre></td></tr></table></figure>

<p>数据库我们使用MySQL，那么我们需要在MySQL数据库中创建一个叫ssm的database数据库，再创建两张表emp(员工表)和dept(部门表)   </p>
<p><strong><center>dept(部门表)</center></strong>  </p>
<table>
<thead>
<tr>
<th>列名</th>
<th>数据类型</th>
<th>长度</th>
<th>非空？</th>
<th>主键？</th>
<th>自增？</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>dept_id</td>
<td>int</td>
<td>11</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>部门编号</td>
</tr>
<tr>
<td>dept_name</td>
<td>varchar</td>
<td>255</td>
<td>yes</td>
<td></td>
<td></td>
<td>部门名称</td>
</tr>
</tbody></table>
<p><strong><center>emp(员工表)</center></strong>  </p>
<table>
<thead>
<tr>
<th>列名</th>
<th>数据类型</th>
<th>长度</th>
<th>非空？</th>
<th>主键？</th>
<th>自增？</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>emp_id</td>
<td>int</td>
<td>11</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>员工编号</td>
</tr>
<tr>
<td>emp_name</td>
<td>varchar</td>
<td>255</td>
<td>yes</td>
<td></td>
<td></td>
<td>员工姓名</td>
</tr>
<tr>
<td>gender</td>
<td>char</td>
<td>1</td>
<td></td>
<td></td>
<td></td>
<td>性别M/F</td>
</tr>
<tr>
<td>email</td>
<td>varchar</td>
<td>255</td>
<td></td>
<td></td>
<td></td>
<td>邮箱</td>
</tr>
<tr>
<td>fk_dept_id</td>
<td>int</td>
<td>11</td>
<td></td>
<td></td>
<td></td>
<td>部门编号</td>
</tr>
</tbody></table>
<p>要使用properties中的信息，就需要使用context标签读取database.properties文件，使用bean配置数据源  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:database.properties"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"comboPooledDataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.user&#125;"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>数据源配置好了，那么我们所需要的<strong>业务逻辑组件</strong>pojo也需要被扫描进来，它和SpringMVC不同的是，SpringMVC只扫描控制器controller，它通过<code>&lt;context:exclude-filter/&gt;</code>扫描除controller之外的所有  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.teaper.www"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p><strong>配置和Myatis的整合</strong>，配置一个sqlSessionFactory工厂，dataSource指定使用我们上面配置好的id为comboPooledDataSource的数据源；configLocation指定mybatis全局文件的位置；mapperLocations指定mybatis的mapper文件位置  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"comboPooledDataSource"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:mapper/*.xml"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们需要在src/main/resources下新建mybatis-config.xml，创建方式可以通过配置DTD文件获得文件模板  </p>
<blockquote>
<p>下载<a href="http://mybatis.org/dtd/mybatis-3-config.dtd" rel="external nofollow noopener noreferrer" target="_blank">mybatis-3-config.dtd</a>和<a href="http://mybatis.org/dtd/mybatis-3-mapper.dtd" rel="external nofollow noopener noreferrer" target="_blank">mybatis-3-mapper.dtd</a>文件<br>然后打开window -&gt; preferences下搜索xml catalog选项卡<br>点击Add按钮添加dtd文件路径，Key的话，分情况填<br>mybatis-3-config.dtd的Key:<code>-//mybatis.org//DTD Config 3.0//EN</code><br>mybatis-3-mapper.dtd的Key:<code>-//mybatis.org//DTD Mapper 3.0//EN</code>  </p>
</blockquote>
<p>其次需要在src/main/resources下新建一个mapper文件夹，用于存放所有的Mapper.xml  </p>
<p><strong>配置扫描器</strong>，将mybatis的dao接口实现加入到IOC容器中  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"cn.teaper.www.dao"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>配置<strong>事务管理器</strong>DataSourceTransactionManager,负责数据源中的开启关闭回滚操作  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSourceTransactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 指定被控制的数据源 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"comboPooledDataSource"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>事务管理器配置好了,我们就可以开启基于注解的事务(常用)和使用XML配置形式的事务(重要)<br>aop:pointcut定义切入点表达式：<code>..</code>表示包下以及其子包都可以切入；<code>(..)</code>表示方法内参数任意多也行<br><code>&lt;aop:advisor&gt;</code>配置事务增强(事务如何切入);引用下方<code>&lt;tx:advice&gt;</code>的id；<code>&lt;pointcut-ref&gt;</code>引用上方<code>&lt;aop:pointcut&gt;</code>的id<br><code>&lt;tx:advice&gt;</code>中的<code>*</code>表示所有方法都是事务方法，<code>get*</code>表示以get开始的所有方法，get方法假设都为查询，使用<code>read-only=&quot;true&quot;</code>指定只读做些许优化，<code>transaction-manager</code>属性指定切入的事务管理器id<br>其中<code>&lt;aop:config/&gt;</code>定义切入点文件,<code>&lt;tx:advice/&gt;</code>对切入点文件中的方法进行增强,transaction-manager指定切入数据的来源  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* cn.teaper.www.service..*(..))"</span> <span class="attr">id</span>=<span class="string">"pointcut"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"dataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="编写mybatis-config-xml"><a href="#编写mybatis-config-xml" class="headerlink" title="编写mybatis-config.xml"></a>编写mybatis-config.xml</h5><p>在全局configuration标签中配置一些冷门的MyBatis的设置<code>&lt;settings&gt;</code>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置驼峰命名风格,value="true"开启,这样我们使用MyBatis逆向工程工具的时候就可以生成以驼峰命名风格的bean和Mapper --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span>	</span><br><span class="line"><span class="comment">&lt;!-- 配置所有bean来源 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.teaper.www.pojo"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="MyBatis逆向工程工具"><a href="#MyBatis逆向工程工具" class="headerlink" title="MyBatis逆向工程工具"></a>MyBatis逆向工程工具</h4><p>使用<a href="http://www.mybatis.org/generator/index.html" rel="external nofollow noopener noreferrer" target="_blank">mybatis-generator</a>逆向生成bean和Mapper,第一步pom.xml中引入jar包<code>mybatis-generator-core-1.3.5.jar</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>编写在项目根目录创建mbg.xml,模板<a href="http://www.mybatis.org/generator/configreference/xmlconfig.html" rel="external nofollow noopener noreferrer" target="_blank">参考</a>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">  PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">  "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 不生成注释 --&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span> =<span class="string">"suppressAllComments"</span> <span class="attr">value</span> =<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 配置数据库连接信息 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/ssm?useSSL=true"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">password</span>=<span class="string">"fvh2014"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为 Integer，为 true时把JDBC DECIMAL 和 NUMERIC 类型解析为java.math.BigDecimal --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">javaTypeResolver</span> &gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 指定javabean生成的位置:targetProject=”.\src” 适用于windows;targetProject=”./src”适用于linux --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"cn.teaper.pojo"</span> <span class="attr">targetProject</span>=<span class="string">"./src/main/java"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 指定SQl映射文件(mapper.xml)生成的位置 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span>  <span class="attr">targetProject</span>=<span class="string">"./src/main/resources"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 指定dao接口生成的位置(mapper接口) --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>=<span class="string">"cn.teaper.dao"</span>  <span class="attr">targetProject</span>=<span class="string">"./src/main/java"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- table指定每个表的生成策略 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"emp"</span> <span class="attr">domainObjectName</span>=<span class="string">"Emp"</span> &gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"dept"</span> <span class="attr">domainObjectName</span>=<span class="string">"Dept"</span> &gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>在tools包下创建测试的Java代码MBG.java,内容<a href="http://www.mybatis.org/generator/running/runningWithJava.html" rel="external nofollow noopener noreferrer" target="_blank">参考</a>;运行成功后刷新项目,查看目录下是否自动生成了想要的bean和Mapper  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MBG</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		<span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">		File configFile = <span class="keyword">new</span> File(<span class="string">"mbg.xml"</span>);</span><br><span class="line">		ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">		Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">		DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">		MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">		myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><span style="color:#ff0000;">注意：MyBatis逆向工程生成的Mapper还不能完全使用，缺少表连接查询，所以需要进一步修改；pojo中除了普通javabean，会有复杂的javaBeanExample.java文件，如果你不需要可以删除</span>  </p>
<h4 id="修改生成的pojo和Mapper信息"><a href="#修改生成的pojo和Mapper信息" class="headerlink" title="修改生成的pojo和Mapper信息"></a>修改生成的pojo和Mapper信息</h4><p>由于逆向工程生成的SQL缺少联合表的CRUD操作，所以需要在其基础上稍作添加  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EmpMapper.java新增两个查询</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insertSelectiveWithDept</span><span class="params">(Emp record)</span></span>;</span><br><span class="line"><span class="function">Emp <span class="title">selectByPrimaryKeyWithDept</span><span class="params">(Integer empId)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增dept对象，希望查询员工的时候顺便查询其部门信息</span></span><br><span class="line"><span class="keyword">private</span> Dept dept;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Dept <span class="title">getDept</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> dept;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDept</span><span class="params">(Dept dept)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.dept = dept;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查询员工带部门信息的resultMap --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"WithDeptResultMap"</span> <span class="attr">type</span>=<span class="string">"cn.teaper.www.pojo.Emp"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"emp_id"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"empId"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"emp_name"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"empName"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">jdbcType</span>=<span class="string">"CHAR"</span> <span class="attr">property</span>=<span class="string">"gender"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"email"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"fk_dept_id"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"fkDeptId"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- association指定联合查询部门字段的封装 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">javaType</span>=<span class="string">"cn.teaper.www.pojo.Dept"</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"dept_id"</span> <span class="attr">property</span>=<span class="string">"deptId"</span>/&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"deptName"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--查询员工带部门信息的SQL--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"WithDept_Column_List"</span>&gt;</span></span><br><span class="line">    e.emp_id, e.emp_name, e.gender, e.email, e.fk_dept_id , d.dept_id , d.dept_name</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">&lt;!-- 查询员工带部门信息的两个方法</span></span><br><span class="line"><span class="comment">  int insertSelectiveWithDept(Emp record);</span></span><br><span class="line"><span class="comment">  Emp selectByPrimaryKeyWithDept(Integer empId); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByExampleWithDept"</span> <span class="attr">parameterType</span>=<span class="string">"cn.teaper.www.pojo.EmpExample"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span><br><span class="line">    select</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"distinct"</span>&gt;</span></span><br><span class="line">      distinct</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--指定上方查询的信息，SQL修改成左连接查询--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"WithDept_Column_List"</span> /&gt;</span></span><br><span class="line">    FROM emp e </span><br><span class="line">    LEFT JOIN dept d ON e.fk_dept_id=d.dept_id</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"orderByClause != null"</span>&gt;</span></span><br><span class="line">      order by $&#123;orderByClause&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByPrimaryKeyWithDept"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Integer"</span> <span class="attr">resultMap</span>=<span class="string">"WithDeptResultMap"</span>&gt;</span></span><br><span class="line">    select </span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"WithDept_Column_List"</span> /&gt;</span></span><br><span class="line">    FROM emp e </span><br><span class="line">    LEFT JOIN dept d ON e.fk_dept_id=d.dept_id </span><br><span class="line">    where emp_id = #&#123;empId,jdbcType=INTEGER&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="测试Mapper接口"><a href="#测试Mapper接口" class="headerlink" title="测试Mapper接口"></a>测试Mapper接口</h4><p>在<code>cn.teaper.www.test</code>中创建一个测试类<code>mapperTest.java</code>测试Dao层的工作  </p>
<p>由于我们的是Spring项目，所以这里推荐使用Spring单元测试，可以自动注入我们需要的组件，使用Spring单元测步骤如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试Dao层的工作</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> teaper</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(locations=&#123;<span class="string">"classpath:applicationContext.xml"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mapperTest</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	DeptMapper deptMapper;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 测试DeptMapper</span></span><br><span class="line"><span class="comment">	 * Spring项目推荐使用Spring单元测试，可以自动注入我们需要的组件</span></span><br><span class="line"><span class="comment">	 * 1、在pom.xml导入SpringTest的模块spring-test</span></span><br><span class="line"><span class="comment">	 * 2、测试类上添加<span class="doctag">@ContextConfiguration</span>注解指定Spring配置文件的位置，帮我们创建出IOC容器；该注解有个属性locations指定配置文件</span></span><br><span class="line"><span class="comment">	 * 3、测试类上添加Juint的<span class="doctag">@RunWith</span>注解指定使用哪个单元测试用例  </span></span><br><span class="line"><span class="comment">	 * 4、直接使用<span class="doctag">@Autowired</span>要使用的bean</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//1、创建SpringIOC容器</span></span><br><span class="line">		<span class="comment">//ApplicationContext ioc = new ClassPathXmlApplicationContext("applicationContext.xml");</span></span><br><span class="line">		<span class="comment">//2、从容器中获取Mapper</span></span><br><span class="line">		<span class="comment">//DeptMapper bean = ioc.getBean(DeptMapper.class);</span></span><br><span class="line">		</span><br><span class="line">		System.out.println(deptMapper);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用Juint Test运行mapperTest()方法没有报错，并且输出黑色的<strong>org.apache.ibatis.binding.MapperProxy@26adfd2d</strong>就说明正常，通过上面4步已经测试Dao层没有问题了，那么就可以插入一些数据来测试具体的CRUD方法  </p>
<p>测试插入部门功能insertSelective(Dept record)，需要入参一个dept对象，这里需要先去Dept.java添加两个构造方法  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//为dept生成两个构造方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Dept</span><span class="params">(Integer deptId, String deptName)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">super</span>();</span><br><span class="line">	<span class="keyword">this</span>.deptId = deptId;</span><br><span class="line">	<span class="keyword">this</span>.deptName = deptName;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Dept</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">super</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在mapperTest.java的testDao()方法中追加两行命令，运行之后有添加进去就OK啦  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5、插入几个部门</span></span><br><span class="line">deptMapper.insertSelective(<span class="keyword">new</span> Dept(<span class="keyword">null</span>,<span class="string">"公关部"</span>));</span><br><span class="line">deptMapper.insertSelective(<span class="keyword">new</span> Dept(<span class="keyword">null</span>,<span class="string">"教职部"</span>));</span><br></pre></td></tr></table></figure>

<p>同理，插入员工也是添加构造方法，调用empMapper的insertSelective()方法；为了后面方便有数据分页，我们使用可以批量操作的SqlSession<strong>批量插入1000条数据</strong>  </p>
<p>首先在applicationContext.xml中配置一个可以执行批量操作的SqlSession，创建一个sqlSession的bean，引入之前配置好的sqlSessionFactory，MyBatis执行器类型<code>executorType</code>设置为<code>BATCH</code>  </p>
<blockquote>
<p>MyBatis执行器类型如下：<br>SIMPLE：这个类型不做特殊的事情，它只为每个语句创建一个PreparedStatement<br>REUSE：这种类型将重复使用PreparedStatements<br>BATCH：这个类型批量更新，且必要地区别开其中的select 语句，确保动作易于理解  </p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置一个可以执行批量操作的SqlSession --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"executorType"</span> <span class="attr">value</span>=<span class="string">"BATCH"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在testDao.java中@Autowired一个SqlSession对象，然后在之前的testDao()方法中追加以下内容<br>使用javaJDK提供的UUID.randomUUID().toString()方法自动生成主键，截取前5个字符拼接变量<code>i</code>,将其拼接到insertSelective()入参中  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//7、使用可以执行批量操作的SQLSession批量插入多个员工</span></span><br><span class="line">EmpMapper empMapper = sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">	String uid = UUID.randomUUID().toString().substring(<span class="number">0</span>,<span class="number">5</span>)+i;</span><br><span class="line">	empMapper.insertSelective(<span class="keyword">new</span> Emp(<span class="keyword">null</span>,uid,<span class="string">"M"</span>,uid+<span class="string">"@teaper.cn"</span>,<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分页插件PageHelper"><a href="#分页插件PageHelper" class="headerlink" title="分页插件PageHelper"></a>分页插件PageHelper</h4><p><a href="https://github.com/pagehelper/Mybatis-PageHelper" rel="external nofollow noopener noreferrer" target="_blank">PageHelper</a>是Mybatis通用分页插件，首先在pom.xml中引入相关最新jar包，它包含了<code>pagehelper-5.1.2.jar</code>和<code>jsqlparser-1.0.jar</code>包  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入pagehelper分页插件 </span></span><br><span class="line"><span class="comment">	pagehelper-5.1.2.jar</span></span><br><span class="line"><span class="comment">	jsqlparser-1.0.jar</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后在<code>mybatis-config.xml</code>中配置拦截器插件  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">    plugins在配置文件中的位置必须符合要求，否则会报错，顺序如下:</span></span><br><span class="line"><span class="comment">    properties?, settings?, </span></span><br><span class="line"><span class="comment">    typeAliases?, typeHandlers?, </span></span><br><span class="line"><span class="comment">    objectFactory?,objectWrapperFactory?, </span></span><br><span class="line"><span class="comment">    plugins?, </span></span><br><span class="line"><span class="comment">    environments?, databaseIdProvider?, mappers?</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- com.github.pagehelper为PageHelper类所在包名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后就可以在Controller.java中调用<code>PageHelper.startPage(int pageNum, int pageSize);</code>方法；将startPage后面紧跟的查询<code>empService.getAll();</code>定义为一个分页查询<br>分页查询的结果以及<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md" rel="external nofollow noopener noreferrer" target="_blank">分页参数</a>，可以使用PageInfo对象接收，然后使用model将其返回到前端页面   </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/emps"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getEmps</span><span class="params">(@RequestParam(value=<span class="string">"pn"</span>,defaultValue=<span class="string">"1"</span>)</span>Integer pn,Model model) </span>&#123;</span><br><span class="line">	<span class="comment">//这不是一个分页查询</span></span><br><span class="line">	<span class="comment">//引入pageHelper分页插件</span></span><br><span class="line">	<span class="comment">//在查询之前只需要调用PageHelper.startPage(int pageNum, int pageSize);方法</span></span><br><span class="line">	PageHelper.startPage(pn, <span class="number">5</span>);</span><br><span class="line">	<span class="comment">//startPage后面紧跟的查询empService.getAll();就是一个分页查询</span></span><br><span class="line">	List&lt;Emp&gt; emps = empService.getAll();</span><br><span class="line">	<span class="comment">//因为PageInfo包含了非常全面的分页属性以及查询出来的数据，使用PageInfo包装查询结果后，就只需要讲PageInfo交给页面即可</span></span><br><span class="line">	<span class="comment">//传入要连续显示的页数5</span></span><br><span class="line">	PageInfo page = <span class="keyword">new</span> PageInfo(emps,<span class="number">5</span>);</span><br><span class="line">	model.addAttribute(<span class="string">"pageInfo"</span>,page);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了保险期间，我们需要事先测试下数据，这里使用Spring的单元测试模块<strong>测试MVC</strong><br>在test包下新建一个<code>MvcTest.java</code>文件，基本配置和上面的<a href="#测试mapper接口">测试Mapper接口</a>过程是一样的，不过<code>@ContextConfiguration</code>中只有<code>applicationContext.xml</code>是不够的，还需要加入<code>spring-mvc.xml</code>  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="line">@ContextConfiguration(locations=&#123;<span class="string">"classpath:applicationContext.xml"</span>,<span class="string">"classpath:spring-mvc.xml"</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>然后在MvcTest中创建一个<code>MockMvc</code>对象来虚拟MVC请求，获取处理结果；使用<code>MockMvc</code>对象之前还需要使用<code>MockMvcBuilders.webAppContextSetup().build()</code>方法初始化它，并且传入SpringMVC的ioc容器<code>WebApplicationContext</code>，SpringMVC容器里边的东西我们可以<code>@Autowired</code>自动装配，但是IOC容器自己需要在Class上使用<code>@WebAppConfiguration</code>才能装配进去；<code>initMokcMvc()</code>初始化方法我们每次都要使用，所以使用Juint的<code>@Before</code>注解标记它</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@WebAppConfiguration</span></span><br><span class="line"><span class="meta">@ContextConfiguration</span>(locations=&#123;<span class="string">"classpath:applicationContext.xml"</span>,<span class="string">"classpath:spring-mvc.xml"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MvcTest</span> </span>&#123;</span><br><span class="line">	<span class="comment">//传入SpringMVC的IOC</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	WebApplicationContext context;</span><br><span class="line">	<span class="comment">//虚拟MVC请求，获取处理结果</span></span><br><span class="line">	MockMvc mockMvc;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Before</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMokcMvc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		mockMvc = MockMvcBuilders.webAppContextSetup(context).build();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们就可以在class中编写测试方法<code>testPage()</code>了  
使用MockMvc的<code>.perform().andReturn()</code>方法拿到返回值，传入一个requestBuilder对象，这里我们可以使用<code>MockMvcRequestBuilders</code>模拟一个get/post请求(这里.get()是get请求)，<code>.param()</code>传入请求参数页面大小和页码，把该抛出异常抛出去<br>请求成功以后，请求域中会有PageInfo，我们可以取出PageInfo中的数据，使用<code>result.getRequest()</code>拿到请求对象</p>
<blockquote>
<p>这里安利一个快捷键<code>Ctrl+1 Enter</code>或者<code>Ctrl+2 L</code>可以自动可自动补全代码</p>
</blockquote>
<p>使用<code>equest.getAttribute()</code>获取PageInfo对象，打印PageInfo中的内容，查询数据在PageInfo的<code>.getList()</code>方法中可以获取到  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPage</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	<span class="comment">//模拟请求拿到返回值</span></span><br><span class="line">	MvcResult result = mockMvc.perform(MockMvcRequestBuilders.get(<span class="string">"/emps"</span>).param(<span class="string">"pn"</span>, <span class="string">"2"</span>)).andReturn();</span><br><span class="line">	<span class="comment">//请求成功以后，请求域中会有PageInfo，我们可以取出PageInfo进行验证</span></span><br><span class="line">	MockHttpServletRequest request= result.getRequest();</span><br><span class="line">	PageInfo pi = (PageInfo) request.getAttribute(<span class="string">"pageInfo"</span>);</span><br><span class="line">	System.out.println(<span class="string">"当前页码"</span>+pi.getPageNum());</span><br><span class="line">	System.out.println(<span class="string">"总页码"</span>+pi.getPages());</span><br><span class="line">	System.out.println(<span class="string">"总记录数"</span>+pi.getTotal());</span><br><span class="line">	System.out.println(<span class="string">"在页面需要连续显示的页码"</span>);</span><br><span class="line">	<span class="keyword">int</span>[] nums = pi.getNavigatepageNums();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i : nums) &#123;</span><br><span class="line">		System.out.println(<span class="string">""</span>+i);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取员工数据</span></span><br><span class="line">	List&lt;Emp&gt; list = pi.getList();</span><br><span class="line">	<span class="keyword">for</span>(Emp emp : list) &#123;</span><br><span class="line">		System.out.println(<span class="string">"ID:"</span>+emp.getEmpId()+<span class="string">"==&gt; NAME:"</span>+emp.getEmpName());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><span style="color:#ff0000;">注意：如果运行后报<code>java.lang.NoClass.DefFoundError:javax/servlet/SessionCookieConfig</code>错误，<code>javax/servlet</code>下找不到<code>SessionCookieConfig</code>这个类，原因是Spring4测试的时候需要Servlet3.0的支持，我们在pom中引入<code>javax.servlet-api</code>3.0以上版本的jar包</span>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="页面数据展示"><a href="#页面数据展示" class="headerlink" title="页面数据展示"></a>页面数据展示</h4><p>项目运行后，首先访问<code>index.jsp</code>，然后<code>index.jsp</code>发送一个<code>/emps</code>请求给controller控制器  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jsp:forward</span> <span class="attr">page</span>=<span class="string">"/emps"</span>&gt;</span><span class="tag">&lt;/<span class="name">jsp:forward</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>controller控制器处理<code>/emps</code>请求，查到数据，来到<code>list.jsp</code>页面展示，所以我们直接创建一个<code>list.jsp</code>页面<br>要使用Bootstrap需要引入相关样式和js，还有JQuery的js(Jquery.js必须在所有js之前)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入jQuery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"static/js/jquery-3.3.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入bootstrop样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>安利一下路径问题：<br>不以<code>/</code>开始的相对路径，找资源，以当前资源的路径为基准<br>推荐使用以<code>/</code>开始的相对路径，找资源，以服务器的路径(<code>https://localhost:3306</code>)为基准，需要加上项目名，完整路径应该是(<code>https://localhost:3306/ssm/index.jsp</code>)  </p>
</blockquote>
<p>当然服务器的路径不是写死的，所以可以直接jsp使用小脚本方式获取服务器路径  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">	<span class="attr">pageContext.setAttribute</span>("<span class="attr">APP_PATH</span>",<span class="attr">request.getContextPath</span>());</span></span><br><span class="line"><span class="tag">%&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后使用<code>APP_PATH</code>替换文件路径中的服务器路径，<strong>替换结果</strong>如下：  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入jQuery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.3.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入bootstrop样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来就可以借助bootstrap的<a href="https://getbootstrap.com/docs/3.3/css/" rel="external nofollow noopener noreferrer" target="_blank">CSS样式</a>和<a href="https://getbootstrap.com/docs/3.3/components/" rel="external nofollow noopener noreferrer" target="_blank">组件</a>编写list.jsp页面  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 搭建页面信息 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 标题 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">h1</span>&gt;</span>Spring+SpringMVC+MyBatis框架整合<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 按钮 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 表格数据 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">th</span>&gt;</span>员工姓名(empName)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">th</span>&gt;</span>性别(gender)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">th</span>&gt;</span>邮箱(email)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">th</span>&gt;</span>所在部门(deptName)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">td</span>&gt;</span>卜衔之<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">td</span>&gt;</span>F<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">td</span>&gt;</span>www@teaper.cn<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">td</span>&gt;</span>开发部<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>编辑</span><br><span class="line">							<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>删除</span><br><span class="line">							<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 分页 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 分页文字信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span>当前记录数：×××<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 分页条信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">"Page navigation"</span>&gt;</span></span><br><span class="line">				  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span><br><span class="line">				  	<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">				      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">aria-label</span>=<span class="string">"Previous"</span>&gt;</span></span><br><span class="line">				        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;laquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">				      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">				      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">aria-label</span>=<span class="string">"Next"</span>&gt;</span></span><br><span class="line">				        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;raquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">				      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>末页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">				  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="http://ww1.sinaimg.cn/large/006kWbIoly1g2kew01il2j30wf07vmyi.jpg" alt><br>前端页面写好了，我们需要把请求的数据解析出来，遍历在<code>&lt;tr&gt;</code>标签中，需要引入jstl和EL表达式  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@taglib</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br></pre></td></tr></table></figure>

<p><span style="color:#ff0000;">注意：要使用jstl需要在pom.xml中引入相关jar文件</span>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>那么遍历部门信息在列表里，之前的  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>卜衔之<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>F<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>www@teaper.cn<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>开发部<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>编辑</span><br><span class="line">		<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>删除</span><br><span class="line">		<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>就要修改成  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$&#123;pageInfo.list &#125;"</span> <span class="attr">var</span>=<span class="string">"emp"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;emp.empId &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;emp.empName &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;emp.gender=="M"?"女":"男" &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;emp.email &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;emp.dept.deptName &#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>编辑</span><br><span class="line">			<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>删除</span><br><span class="line">			<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>分页信息(来源pageInfo)修改为  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 分页文字信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span>总$&#123;pageInfo.pages&#125;页 当前第$&#123;pageInfo.pageNum&#125;页 总$&#123;pageInfo.total&#125;条数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>分页条连续显示的页码(pageInfo.navigatepageNums)修改为  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH &#125;/emps?pn=1"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;pageInfo.hasPreviousPage ==true&#125;"</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH &#125;/emps?pn=$&#123;pageInfo.pageNum-1&#125;"</span> <span class="attr">aria-label</span>=<span class="string">"Previous"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;laquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$&#123;pageInfo.navigatepageNums &#125;"</span> <span class="attr">var</span>=<span class="string">"page_Num"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;page_Num == pageInfo.pageNum &#125;"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>$&#123;page_Num &#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;page_Num != pageInfo.pageNum &#125;"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH &#125;/emps?pn=$&#123;page_Num&#125;"</span>&gt;</span>$&#123;page_Num &#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;pageInfo.hasNextPage ==true&#125;"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH &#125;/emps?pn=$&#123;pageInfo.pageNum+1&#125;"</span> <span class="attr">aria-label</span>=<span class="string">"Next"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;raquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH &#125;/emps?pn=$&#123;pageInfo.pages&#125;"</span>&gt;</span>末页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>点击发送请求方式：${APP_PATH }/emps?pn=1<br>pn：页码<br>hasPreviousPage：是否有上一页<br>hasNextPage：是否有下一页<br>navigatepageNums：所有导航页号<br>pageNum：当前页</p>
</blockquote>
<h4 id="使用ajax返回json方式修改list-jsp"><a href="#使用ajax返回json方式修改list-jsp" class="headerlink" title="使用ajax返回json方式修改list.jsp"></a>使用ajax返回json方式修改list.jsp</h4><p>注释掉<code>Empcontroller.java</code>中的<code>@RequestMapping(&quot;/emps&quot;)</code>，我们重新写过一个返回JSON格式的请求  </p>
<blockquote>
<p><code>@ResponseBody</code>需要在<code>pom.xml</code>中导入<code>jackson-databind</code>架包  </p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2、以JSON方式显示查询结果</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/emps"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> PageInfo <span class="title">getEmpsWithJson</span><span class="params">(@RequestParam(value=<span class="string">"pn"</span>,defaultValue=<span class="string">"1"</span>)</span>Integer pn) </span>&#123;</span><br><span class="line">	PageHelper.startPage(pn, <span class="number">5</span>);</span><br><span class="line">	List&lt;Emp&gt; emps = empService.getAll();</span><br><span class="line">	PageInfo page = <span class="keyword">new</span> PageInfo(emps,<span class="number">5</span>);</span><br><span class="line">	<span class="keyword">return</span> page;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查询方式不变，只不过之前是使用一个<code>Model</code>对象返回查询结果，现在只需要加上<code>@ResponseBody</code>注解，就可以直接返回<code>JSON</code>格式的字符串<a href="http://jason.sourceforge.net/wp/" rel="external nofollow noopener noreferrer" target="_blank">jason</a><strong>(不清楚看下图)</strong>   </p>
<p>浏览器打开<a href="http://localhost:8080/ssm/emps?pn=1" rel="external nofollow noopener noreferrer" target="_blank">http://localhost:8080/ssm/emps?pn=1</a>后会显示一连串的JSON格式信息(推荐一个谷歌插件<a href="https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh/related" rel="external nofollow noopener noreferrer" target="_blank">JSON Viewer</a>可以格式化显示)<br><img src="http://ww1.sinaimg.cn/large/006kWbIogy1g1g5it7e1qj31gv0qadib.jpg" alt>  </p>
<p>使用<code>getEmpsWithJson()</code>方法直接返回查询结果是OK的<br>但是我们Controller中不只有查询方法，还有update,insert,delete操作<br>所以，我们除了返回查询结果外还要返回失败或成功的提示消息<br>所以在<code>pojo</code>包下新建一个<code>Msg.java</code>，定义两个静态变量<code>code</code>和<code>msg</code>以及两个返回成功/失败方法<br>为了可以把PageInfo中的查询结果也绑定到Msg对象上，并且后面需要用ajax的date字段(&lt;k,v&gt;类型的),所以需要定义一个&lt;key,value&gt;类型的<code>add()</code>方法  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.teaper.www.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通用的update,insert,delete返回执行结果消息的类(执行成功还是失败)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> teaper</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Msg</span> </span>&#123;</span><br><span class="line">	<span class="comment">//状态码：1（成功） 0(失败)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">	<span class="comment">//提示信息</span></span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br><span class="line">	<span class="comment">//用户要返回给浏览器的数据  </span></span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,Object&gt; extend = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> code;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(<span class="keyword">int</span> code)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.code = code;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> msg;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getEXtend</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> extend;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEXtend</span><span class="params">(Map&lt;String, Object&gt; extend)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.extend = extend;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义两个成功||失败方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Msg <span class="title">success</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Msg result = <span class="keyword">new</span> Msg();</span><br><span class="line">		result.setCode(<span class="number">1</span>);</span><br><span class="line">		result.setMsg(<span class="string">"处理成功！"</span>);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Msg <span class="title">fail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Msg result = <span class="keyword">new</span> Msg();</span><br><span class="line">		result.setCode(<span class="number">0</span>);</span><br><span class="line">		result.setMsg(<span class="string">"处理失败！"</span>);</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个可以快捷绑定pageInfo信息的方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Msg <span class="title">add</span><span class="params">(String Key,Object value)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getEXtend().put(Key, value);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修改<code>getEmpsWithJson()</code>方法，不返回<code>PageInfo</code>对象了，修改成<code>Msg</code>对象，return方式也从<code>return page;</code>改成<code>return Msg.success().add(&quot;pageInfo&quot;,page);</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2、以JSON方式显示查询结果，@ResponseBody需要在pom.xml中导入jackson-databind架包</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/emps"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Msg <span class="title">getEmpsWithJson</span><span class="params">(@RequestParam(value=<span class="string">"pn"</span>,defaultValue=<span class="string">"1"</span>)</span>Integer pn) </span>&#123;</span><br><span class="line">	PageHelper.startPage(pn, <span class="number">5</span>);</span><br><span class="line">	List&lt;Emp&gt; emps = empService.getAll();</span><br><span class="line">	PageInfo page = <span class="keyword">new</span> PageInfo(emps,<span class="number">5</span>);</span><br><span class="line">	<span class="keyword">return</span> Msg.success().add(<span class="string">"pageInfo"</span>,page);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看执行结果<a href="http://localhost:8080/ssm/emps?pn=5" rel="external nofollow noopener noreferrer" target="_blank">http://localhost:8080/ssm/emps?pn=5</a>如下：<br><img src="http://ww1.sinaimg.cn/large/006kWbIogy1g1g6tepwdij31gu0qbtb9.jpg" alt><br>已经比之前的JSON多出了<code>code</code>、<code>msg</code>、<code>extend</code>信息  </p>
<h4 id="使用JavaScript的DOM对象处理JSON数据，返回到页面"><a href="#使用JavaScript的DOM对象处理JSON数据，返回到页面" class="headerlink" title="使用JavaScript的DOM对象处理JSON数据，返回到页面"></a>使用JavaScript的DOM对象处理JSON数据，返回到页面</h4><p>改造<code>index.jsp</code>，为了留下原来的数据，把原来的<code>index,jsp</code>重命名为<code>index-off.jsp</code><br>重新在<code>webapp</code>下创建一个<code>index.jsp</code>，把<code>list.jsp</code>的内容复制到<code>index.jsp</code>中  
把原来以JSTL和EL表达式遍历的<code>${pageInfo.list}</code>下的所有数据删除，包括表格数据遍历个分页条显示  </p>
<!--然后在`</body>`上引入一个js文件`index.js`  -->
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%@taglib</span> <span class="attr">uri</span>=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> <span class="attr">prefix</span>=<span class="string">"c"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">	<span class="attr">pageContext.setAttribute</span>("<span class="attr">APP_PATH</span>",<span class="attr">request.getContextPath</span>());</span></span><br><span class="line"><span class="tag">%&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入jQuery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.3.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入bootstrop样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 搭建页面信息 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 标题 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">h1</span>&gt;</span>Spring+SpringMVC+MyBatis框架整合<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 按钮 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 表格数据 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span><br><span class="line">			    <span class="comment">&lt;!-- 为了jquery获取对象，这里需要一个id:emps_tables --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_tables"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">th</span>&gt;</span>员工姓名(empName)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">th</span>&gt;</span>性别(gender)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">th</span>&gt;</span>邮箱(email)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">th</span>&gt;</span>所在部门(deptName)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">							</span><br><span class="line">						<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 分页 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 分页文字信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span>总页 当前第页 总条数据<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 分页条信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span><br><span class="line">				</span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来在<code>index.jsp</code>的<code>&lt;/body&gt;</code>标签上编写js代码，需要用到Ajax来做异步调用，不会Ajax参照<a href="http://jquery.cuishifeng.cn/jQuery.Ajax.html" rel="external nofollow noopener noreferrer" target="_blank">jQuery API 中文文档</a>    </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">//1、页面加载完成以后，直接发送Ajax请求，获取分页数据</span></span></span><br><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">	$.ajax(&#123;</span></span><br><span class="line"><span class="javascript">		url: <span class="string">"$&#123;APP_PATH&#125;/emps"</span>,</span></span><br><span class="line"><span class="javascript">		data: <span class="string">"pn=1"</span>,</span></span><br><span class="line"><span class="javascript">		type: <span class="string">"GET"</span>,</span></span><br><span class="line"><span class="javascript">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="built_in">console</span>.log(result);</span></span><br><span class="line"><span class="undefined">		&#125;</span></span><br><span class="line"><span class="undefined">	&#125;);</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>刷新<a href="http://localhost:8080/ssm/" rel="external nofollow noopener noreferrer" target="_blank">http://localhost:8080/ssm/</a>页面，在谷歌检索中查看<code>Network</code>面板中的请求信息<br><img src="http://ww1.sinaimg.cn/large/006kWbIogy1g1g8ptifd0j31hc0fumzh.jpg" alt><br>可以看到有一条<code>emps?pn=1</code>的请求，单击之后可以看到请求信息，接下来<strong>解析请求信息</strong>并显示到对应标签下<br>本页面有分页信息和表格信息，所以创建三个方法  </p>
<blockquote>
<p>build_emps_table() 解析显示员工数据<br>build_page_info() 解析显示分页信息<br>build_page_nav() 解析显示分页条  </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1、页面加载完成以后，直接发送Ajax请求，获取分页数据</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: <span class="string">"$&#123;APP_PATH&#125;/emps"</span>,</span><br><span class="line">		data: <span class="string">"pn=1"</span>,</span><br><span class="line">		type: <span class="string">"GET"</span>,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//console.log(result);</span></span><br><span class="line">			<span class="comment">//1、解析显示员工数据 build_emps_table()</span></span><br><span class="line">			build_emps_table(result);</span><br><span class="line">			<span class="comment">//2、解析显示分页信息 build_page_info()</span></span><br><span class="line">			build_page_info(result);</span><br><span class="line">			<span class="comment">//3、解析显示分页条 build_page_nav()</span></span><br><span class="line">			build_page_nav(result);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们先<strong>解析员工信息</strong><br>获取<code>result.extend.pageInfo.list</code>下的员工信息赋值给<code>emps</code>对象<br>使用JQuery提供的遍历方法遍历信息<code>emps</code>对象，每次遍历都要绑定一个function事件<br>function中定义每条数据的变量，然后用<code>&lt;td&gt;&lt;/td&gt;</code>去接收<br>创建按钮标签，一层一层<code>append</code>进去，最后交由<code>&lt;tr&gt;&lt;/tr&gt;</code>标签封装好<br><code>appendTo</code>定义好的<code>id</code>为<code>emps_tables</code>的<code>&lt;table&gt;&lt;/table&gt;</code>标签中，然后显示到页面  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build_emps_table</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> emps = result.extend.pageInfo.list;<span class="comment">//所有员工数据</span></span><br><span class="line">	$.each(emps,<span class="function"><span class="keyword">function</span>(<span class="params">index,item</span>)</span>&#123;</span><br><span class="line">		<span class="comment">//alert(item.empName);</span></span><br><span class="line">		<span class="keyword">var</span> empIdTd = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>).append(item.empId);</span><br><span class="line">		<span class="keyword">var</span> empNameTd = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>).append(item.empName);</span><br><span class="line">		<span class="keyword">var</span> genderTd = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>).append(item.gender==<span class="string">'M'</span>?<span class="string">"女"</span>:<span class="string">"男"</span>);</span><br><span class="line">		<span class="keyword">var</span> emailTd = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>).append(item.email);</span><br><span class="line">		<span class="keyword">var</span> deptNameTd = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>).append(item.dept.deptName);</span><br><span class="line">		<span class="comment">//编辑和删除按钮</span></span><br><span class="line">		<span class="comment">/* &lt;button type="button" class="btn btn-primary btn-sm"&gt;</span></span><br><span class="line"><span class="comment">			&lt;span class="glyphicon glyphicon-pencil" aria-hidden="true"&gt;&lt;/span&gt;编辑</span></span><br><span class="line"><span class="comment">		&lt;/button&gt; </span></span><br><span class="line"><span class="comment">		&lt;button type="button" class="btn btn-danger btn-sm"&gt;</span></span><br><span class="line"><span class="comment">			&lt;span class="glyphicon glyphicon-trash" aria-hidden="true"&gt;&lt;/span&gt;删除</span></span><br><span class="line"><span class="comment">		&lt;/button&gt; */</span></span><br><span class="line">		<span class="keyword">var</span> editBtn = $(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>).addClass(<span class="string">"btn btn-primary btn-sm"</span>)</span><br><span class="line">			.append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).addClass(<span class="string">"glyphicon glyphicon-pencil"</span>)).append(<span class="string">"编辑"</span>);</span><br><span class="line">		<span class="keyword">var</span> delBtn = $(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>).addClass(<span class="string">"btn btn-danger btn-sm"</span>)</span><br><span class="line">			.append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).addClass(<span class="string">"glyphicon glyphicon-trash"</span>)).append(<span class="string">"删除"</span>);</span><br><span class="line">		<span class="keyword">var</span> btnTd = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>).append(editBtn).append(<span class="string">" "</span>).append(delBtn);</span><br><span class="line">		<span class="comment">//append方法执行完成以后还会返回原来的元素，所以可以一直.append()下去</span></span><br><span class="line">		$(<span class="string">"&lt;tr&gt;&lt;/tr&gt;"</span>).append(empIdTd)</span><br><span class="line">			.append(empNameTd)</span><br><span class="line">			.append(genderTd)</span><br><span class="line">			.append(emailTd)</span><br><span class="line">			.append(deptNameTd)</span><br><span class="line">			.append(btnTd)</span><br><span class="line">			.appendTo(<span class="string">"#emps_tables tbody"</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来<strong>解析显示分页信息</strong><br>分页数据在<code>result.extend.pageInfo</code>下，我们只在在<code>id</code>为<code>page_info_area</code>的标签下<code>append</code>就行了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function build_page_info(result)&#123;</span><br><span class="line">	$(&quot;#page_info_area&quot;).append(&quot;总&quot;+result.extend.pageInfo.pages+&quot;页 当前第&quot;+result.extend.pageInfo.pageNum+&quot;页 总&quot;+result.extend.pageInfo.total+&quot;条数据&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构建<strong>导航条信息</strong><br>根据原来的导航条静态HTML构建</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build_page_nav</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">	<span class="comment">/* &lt;nav aria-label="Page navigation"&gt;</span></span><br><span class="line"><span class="comment">	  &lt;ul class="pagination"&gt;</span></span><br><span class="line"><span class="comment">	  	&lt;li&gt;&lt;a href="#"&gt;首页&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;</span></span><br><span class="line"><span class="comment">	      &lt;a href="#" aria-label="Previous"&gt;</span></span><br><span class="line"><span class="comment">	        &lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;</span></span><br><span class="line"><span class="comment">	      &lt;/a&gt;</span></span><br><span class="line"><span class="comment">	    &lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;&lt;a href="#"&gt;1&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;&lt;a href="#"&gt;2&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;&lt;a href="#"&gt;3&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;&lt;a href="#"&gt;4&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;&lt;a href="#"&gt;5&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;</span></span><br><span class="line"><span class="comment">	      &lt;a href="#" aria-label="Next"&gt;</span></span><br><span class="line"><span class="comment">	        &lt;span aria-hidden="true"&gt;&amp;raquo;&lt;/span&gt;</span></span><br><span class="line"><span class="comment">	      &lt;/a&gt;</span></span><br><span class="line"><span class="comment">	    &lt;/li&gt;</span></span><br><span class="line"><span class="comment">	    &lt;li&gt;&lt;a href="#"&gt;末页&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">	  &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">	&lt;/nav&gt; */</span></span><br><span class="line">	<span class="keyword">var</span> ul = $(<span class="string">"&lt;ul&gt;&lt;/ul&gt;"</span>).addClass(<span class="string">"pagination"</span>);</span><br><span class="line">	<span class="keyword">var</span> firstPageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(<span class="string">"首页"</span>).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="keyword">var</span> prePageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).append(<span class="string">"&amp;laquo;"</span>)).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> nextPageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).append(<span class="string">"&amp;raquo;"</span>)).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="keyword">var</span> lastPageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(<span class="string">"末页"</span>).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	ul.append(firstPageLi).append(prePageLi);</span><br><span class="line">	<span class="comment">//页码12345,遍历给UL添加页码提示</span></span><br><span class="line">	$.each(result.extend.pageInfo.navigatepageNums,<span class="function"><span class="keyword">function</span>(<span class="params">index,item</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> numLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(item).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">		ul.append(numLi);</span><br><span class="line">	&#125;);</span><br><span class="line">	ul.append(nextPageLi).append(lastPageLi);</span><br><span class="line">	<span class="keyword">var</span> navEle = $(<span class="string">"&lt;nav&gt;&lt;/nav&gt;"</span>).append(ul).appendTo(<span class="string">"#page_nav_area"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构建好还需要完善一下，例如没有上一页数据，首页和上一页按钮不可点，当前页面添加class属性<code>active</code>等，完善后如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解析显示分页条</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build_page_nav</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> ul = $(<span class="string">"&lt;ul&gt;&lt;/ul&gt;"</span>).addClass(<span class="string">"pagination"</span>);</span><br><span class="line">	<span class="keyword">var</span> firstPageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(<span class="string">"首页"</span>).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="keyword">var</span> prePageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).append(<span class="string">"&amp;laquo;"</span>)).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="comment">//如果没有上一页数据，首页和上一页按钮设置不可点属性disabled</span></span><br><span class="line">	<span class="keyword">if</span>(result.extend.pageInfo.hasPreviousPage == <span class="literal">false</span>)&#123;</span><br><span class="line">		firstPageLi.addClass(<span class="string">"disabled"</span>);</span><br><span class="line">		prePageLi.addClass(<span class="string">"disabled"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> nextPageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).append(<span class="string">"&amp;raquo;"</span>)).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="keyword">var</span> lastPageLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(<span class="string">"末页"</span>).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="comment">//如果没有下一页数据，末页和下一页按钮设置不可点属性disabled</span></span><br><span class="line">	<span class="keyword">if</span>(result.extend.pageInfo.hasNextPage == <span class="literal">false</span>)&#123;</span><br><span class="line">		nextPageLi.addClass(<span class="string">"disabled"</span>);</span><br><span class="line">		lastPageLi.addClass(<span class="string">"disabled"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	ul.append(firstPageLi).append(prePageLi);</span><br><span class="line">	<span class="comment">//页码12345,遍历给UL添加页码提示</span></span><br><span class="line">	$.each(result.extend.pageInfo.navigatepageNums,<span class="function"><span class="keyword">function</span>(<span class="params">index,item</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> numLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(item).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">		<span class="comment">//如果当前页是活动页，设置标签属性为active</span></span><br><span class="line">		<span class="keyword">if</span>(result.extend.pageInfo.pageNum == item)&#123;</span><br><span class="line">			numLi.addClass(<span class="string">"active"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		ul.append(numLi);</span><br><span class="line">	&#125;);</span><br><span class="line">	ul.append(nextPageLi).append(lastPageLi);</span><br><span class="line">	<span class="keyword">var</span> navEle = $(<span class="string">"&lt;nav&gt;&lt;/nav&gt;"</span>).append(ul).appendTo(<span class="string">"#page_nav_area"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了每次进行ajax请求，我们把原来的ajax部分抽取成to_page(pageNum)方法，指定默认加载第一页数据  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1、页面加载完成以后，直接发送Ajax请求，获取分页数据</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//去首页</span></span><br><span class="line">	to_page(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">to_page</span>(<span class="params">pn</span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url: <span class="string">"$&#123;APP_PATH&#125;/emps"</span>,</span><br><span class="line">		data: <span class="string">"pn="</span>+pn,</span><br><span class="line">		type: <span class="string">"GET"</span>,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//console.log(result);</span></span><br><span class="line">			<span class="comment">//1、解析显示员工数据 build_emps_table()</span></span><br><span class="line">			build_emps_table(result);</span><br><span class="line">			<span class="comment">//2、解析显示分页信息 build_page_info()</span></span><br><span class="line">			build_page_info(result);</span><br><span class="line">			<span class="comment">//3、解析显示分页条 build_page_nav()</span></span><br><span class="line">			build_page_nav(result);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>导航条绑定单击事件，调用<code>to_page()</code>方法，传入参数<code>pageNum</code>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$.each(result.extend.pageInfo.navigatepageNums,<span class="function"><span class="keyword">function</span>(<span class="params">index,item</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> numLi = $(<span class="string">"&lt;li&gt;&lt;/li&gt;"</span>).append($(<span class="string">"&lt;a&gt;&lt;/a&gt;"</span>).append(item).attr(<span class="string">"href"</span>,<span class="string">"#"</span>));</span><br><span class="line">	<span class="comment">//如果当前页是活动页，设置标签属性为active</span></span><br><span class="line">	<span class="keyword">if</span>(result.extend.pageInfo.pageNum == item)&#123;</span><br><span class="line">		numLi.addClass(<span class="string">"active"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//绑定单击事件，调用to_page()方法</span></span><br><span class="line">	numLi.click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		to_page(item);</span><br><span class="line">	&#125;);</span><br><span class="line">	ul.append(numLi);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>并且在每个标签<code>append()</code>数据前清空原来的数据，这里我就直接写相关代码了    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每次加载前清空表格数据</span></span><br><span class="line">$(<span class="string">"#emps_tables tbody"</span>).empty();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每次加载前清空分页信息</span></span><br><span class="line">$(<span class="string">"#page_info_area"</span>).empty();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每次加载前清空分页条</span></span><br><span class="line">$(<span class="string">"#page_nav_area"</span>).empty();</span><br></pre></td></tr></table></figure>

<p>导航条单击时间搞定了，那么首页、上一页、下一页、末页也绑定单击事件  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//如果没有上一页数据，首页和上一页按钮设置不可点属性disabled</span><br><span class="line">if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span><br><span class="line">	firstPageLi.addClass(&quot;disabled&quot;);</span><br><span class="line">	prePageLi.addClass(&quot;disabled&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	firstPageLi.click(function()&#123;</span><br><span class="line">		to_page(1);</span><br><span class="line">	&#125;);</span><br><span class="line">	prePageLi.click(function()&#123;</span><br><span class="line">		to_page(result.extend.pageInfo.pageNum-1);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//如果没有下一页数据，末页和下一页按钮设置不可点属性disabled</span><br><span class="line">if(result.extend.pageInfo.hasNextPage == false)&#123;</span><br><span class="line">	nextPageLi.addClass(&quot;disabled&quot;);</span><br><span class="line">	lastPageLi.addClass(&quot;disabled&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	lastPageLi.click(function()&#123;</span><br><span class="line">		to_page(result.extend.pageInfo.pages);</span><br><span class="line">	&#125;);</span><br><span class="line">	nextPageLi.click(function()&#123;</span><br><span class="line">		to_page(result.extend.pageInfo.pageNum+1);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了正确性，分页插件提供了一个<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md" rel="external nofollow noopener noreferrer" target="_blank"><strong>分页合理化参数</strong></a>  </p>
<blockquote>
<p><code>reasonable</code>：分页合理化参数，默认值为<code>false</code><br>当该参数设置为 <code>true</code> 时，<code>pageNum&lt;=0</code> 时会查询第一页<br><code>pageNum&gt;pages</code>（超过总数时），会查询最后一页<br>默认<code>false</code> 时，直接根据参数进行查询  </p>
</blockquote>
<p>只需要在<code>mybatis-config.xml</code>中的分页插件部分添加一个<code>&lt;property&gt;</code>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- com.github.pagehelper为PageHelper类所在包名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 分页参数合理化 --&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"reasonable"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="新增功能"><a href="#新增功能" class="headerlink" title="新增功能"></a>新增功能</h4><p>在<code>index.jsp</code>中添加<a href="https://getbootstrap.com/docs/3.3/javascript/#modals-usage" rel="external nofollow noopener noreferrer" target="_blank">模态框代码</a>，指定模态框<code>id</code>为<code>empAddModal</code>，通过js绑定添加按钮单击事件来激活  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 新增按钮模态框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>Modal title<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Save changes<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>为新增按钮添加id属性<code>emp_add_modal_btn</code>  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span> <span class="attr">id</span>=<span class="string">"emp_add_modal_btn"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用js绑定单击事件  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增按钮单击事件</span></span><br><span class="line">$(<span class="string">"#emp_add_modal_btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$(<span class="string">'#empAddModal'</span>).modal(&#123;</span><br><span class="line">		backdrop:<span class="string">"static"</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>修改模态框成我们想要的样子，<code>modal-title</code>修改为<code>员工添加</code>，<code>modal-body</code>中的省略号修改成bootstrap的表单，指定表单每个元素的<code>id</code>和<code>name</code>属性(name属性和javBean保持一致)，<code>placeholder</code>设置默认显示内容，<code>checked=&quot;checked&quot;</code>默认选中一个单选按钮  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 新增按钮模态框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 表单 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>用户名(empName)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>邮箱(email)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@teaper.cn"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>性别(gender)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">		      	<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">				  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_add_input"</span> <span class="attr">value</span>=<span class="string">"F"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span><br><span class="line">				<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">				  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_add_input"</span> <span class="attr">value</span>=<span class="string">"M"</span>&gt;</span> 女</span><br><span class="line">				<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>部门名称(deptName)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">		      	<span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"fkDeptId"</span> <span class="attr">id</span>=<span class="string">"dept_add_select"</span>&gt;</span></span><br><span class="line">				  <span class="comment">&lt;!-- &lt;option value="fkDeptId"&gt;&lt;/option&gt; --&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="http://ww1.sinaimg.cn/large/006kWbIoly1g1jj196pdej30we0cnabj.jpg" alt="新增模态框"><br>加载模态框之前，我们需要发送<code>ajax</code>请求<strong>获取部门信息</strong>的<code>json</code><br>抽取<code>ajax</code>请求为<code>getDepts()</code>方法，在弹出模态框之前调用请求  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增按钮单击事件</span></span><br><span class="line">$(<span class="string">"#emp_add_modal_btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//发送ajax请求，查出部门信息，显示在下拉列表中</span></span><br><span class="line">	getDepts();</span><br><span class="line">	<span class="comment">//弹出模态框</span></span><br><span class="line">	$(<span class="string">'#empAddModal'</span>).modal(&#123;</span><br><span class="line">		backdrop:<span class="string">"static"</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//查出所有部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDepts</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/depts"</span>,</span><br><span class="line">		type:<span class="string">"GET"</span>,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.log(result);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写<code>DeptController.java</code>，自动装配<code>DeptService</code>对象，调用它的<code>getDepts()</code>方法，封装到<code>Msg</code>中返回给页面  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理部门有关的请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> teaper</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeptController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> DeptService deptService;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//返回所有的部门信息</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/depts"</span>)</span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Msg <span class="title">getDepts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//查出的所有部门信息</span></span><br><span class="line">		List&lt;Dept&gt; list = deptService.getDepts();</span><br><span class="line">		<span class="keyword">return</span> Msg.success().add(<span class="string">"depts"</span>,list);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写<code>DeptService.java</code>需要装配<code>DeptMapper</code>，调用它的<code>selectByExample()</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeptService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> DeptMapper deptMapper;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Dept&gt; <span class="title">getDepts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;Dept&gt; list = deptMapper.selectByExample(<span class="keyword">null</span>);</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByExample"</span> <span class="attr">parameterType</span>=<span class="string">"cn.teaper.www.pojo.DeptExample"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span><br><span class="line">    select</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"distinct"</span>&gt;</span></span><br><span class="line">      distinct</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span> /&gt;</span></span><br><span class="line">    from dept</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"orderByClause != null"</span>&gt;</span></span><br><span class="line">      order by $&#123;orderByClause&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>运行之后可以看到请求信息<br><img src="http://ww1.sinaimg.cn/large/006kWbIoly1g1jl0b26i3j31hc0kw0uc.jpg" alt="获取部门信息"><br>获取到数据之后我们就可以把数据绑定到下拉列表中<br><code>$(&quot;#dept_add_select&quot;).empty();</code>清空下拉列表中原来的信息<br>遍历<code>depts</code>中的信息到循环输出的<code>&lt;option&gt;&lt;/option&gt;</code>标签中<br>为了后面添加数据，需要绑定每个下拉选项的<code>value</code>属性为部门编号</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查出所有部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDepts</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/depts"</span>,</span><br><span class="line">		type:<span class="string">"GET"</span>,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//console.log(result);</span></span><br><span class="line">			$(<span class="string">"#dept_add_select"</span>).empty();</span><br><span class="line">			<span class="comment">//显示部门信息在下拉列表中</span></span><br><span class="line">			$.each(result.extend.depts,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">				$(<span class="string">"#dept_add_select"</span>).append($(<span class="string">"&lt;option&gt;&lt;/option&gt;"</span>).append(<span class="keyword">this</span>.deptName).attr(<span class="string">"value"</span>,<span class="keyword">this</span>.deptId))</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，我们就可以开发<strong>保存功能</strong><br>首先给保存按钮绑定单击事件，发送ajax的POST请求，这里我们约定一下Rest风格URI请求类型  </p>
<blockquote>
<p>URI:<br>/emp/{id}    GET查询员工<br>/emp      POST保存员工<br>/emp/{id}    PUT修改员工<br>/emp/{id}    DELETE删除员工  </p>
</blockquote>
<p><span style="color:#ff0000;">查询的时候发<strong>get</strong>请求，新增数据发<strong>post</strong>请求，修改的时候发<strong>put</strong>请求，删除发<strong>delete</strong>请求</span><br>FORM表单<code>$(&quot;#empAddModal form&quot;)</code>的<code>serialize()</code>方法可以获取表单中需要提交的数据  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#emp_save_btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//单击模态框中的保存按钮，讲数据提交给服务器</span></span><br><span class="line">	<span class="comment">//发送ajax请求保存员工</span></span><br><span class="line">	<span class="comment">//alert($("#empAddModal form").serialize());</span></span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/emp"</span>,</span><br><span class="line">		type:<span class="string">"POST"</span>,</span><br><span class="line">		data:$(<span class="string">"#empAddModal form"</span>).serialize(),</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			alert(result.msg);</span><br><span class="line">			<span class="comment">//1、关闭模态框</span></span><br><span class="line">			$(<span class="string">"#empAddModal"</span>).modal(<span class="string">"hide"</span>);</span><br><span class="line">			<span class="comment">//2、来到末页，显示刚才添加的数据</span></span><br><span class="line">			<span class="comment">//发送ajax请求显示最后一页的数据即可</span></span><br><span class="line">			to_page(totalRecord);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>保存成功之后需要关闭模态框，跳转到最后一页，所以需要发送请求查询最后一页数据，由于不知道最后一页数据是第几页，所以我们定义一个全局变量<code>totalRecord</code>去接收，再每次解析分页数据的时候给它赋值，由于我们不知道具体的页数，所以取最大(即多少条数据就多少页)，因为之前我们配置过<strong>分页参数合理化</strong>，当<code>pageNum</code>大于页数的时候查询最后一页  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> totalRecord;<span class="comment">//总记录数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解析显示分页信息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build_page_info</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//每次加载前清空分页信息</span></span><br><span class="line">	$(<span class="string">"#page_info_area"</span>).empty();</span><br><span class="line">	</span><br><span class="line">	$(<span class="string">"#page_info_area"</span>).append(<span class="string">"总"</span>+result.extend.pageInfo.pages+<span class="string">"页 当前第"</span>+result.extend.pageInfo.pageNum+<span class="string">"页 总"</span>+result.extend.pageInfo.total+<span class="string">"条数据"</span>)</span><br><span class="line">	totalRecord = result.extend.pageInfo.total;<span class="comment">//保存总记录数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请求发送到<code>EmpController.java</code>，指定请求类型为<code>method = RequestMethod.POST</code><br>为了知道执行结果成功与否，我们也封装成<code>Msg</code>进行返回  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//员工保存</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/emp"</span>,method = RequestMethod.POST)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Msg <span class="title">saveEmp</span><span class="params">(Emp emp)</span> </span>&#123;</span><br><span class="line">	empService.saveEmp(emp);</span><br><span class="line">	<span class="keyword">return</span> Msg.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>EmpService.java</code>调取<code>empMapper</code>中的<code>insertSelective()</code>方法  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//保存员工对象</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveEmp</span><span class="params">(Emp emp)</span> </span>&#123;</span><br><span class="line">	empMapper.insertSelective(emp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>insertSelective()</code>方法我们之前<a href="#测试mapper接口">测试Mapper接口</a>的时候测试过了，并且批量插入了1000条数据  </p>
<p>员工添加基本完成，但是还为了安全性，还需要<strong>进行校验</strong>，例如：已添加的员工不允许再添加，名字格式，邮箱格式等问题  </p>
<p><strong>前端校验</strong><br>在向数据库提交请求之前，对要提交给服务器的表单数据格式进行校验，创建<code>validate_add_form()</code>方法，返回true/false，校验失败<code>return false;</code>退出方法，不执行后面的ajax数据提交  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2、对要提交给服务器的表单数据格式进行校验</span></span><br><span class="line"><span class="keyword">if</span>(!validate_add_form())&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>定义<code>validate_add_form()</code>方法<br>通过id属性拿到校验数据，定义正则表达式<code>/(^[a-zA-Z0-9_-]{6,16}$)|(^[\u2E80-\u9FFF]{2,5})/</code>，调用正则表达式的test()方法，判断是否满足格式要求<br>如果校验失败，给个提示信息，放回<code>false</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表单数据校验方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate_add_form</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//1、拿到校验数据，使用正则表达式校验</span></span><br><span class="line">	<span class="keyword">var</span> empName = $(<span class="string">"#empName_add_input"</span>).val();</span><br><span class="line">	<span class="keyword">var</span> regName = <span class="regexp">/(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\u2E80-\u9FFF]&#123;2,5&#125;)/</span>;</span><br><span class="line">	<span class="comment">//alert(regName.test(empName));</span></span><br><span class="line">	<span class="keyword">if</span>(!regName.test(empName))&#123;</span><br><span class="line">		<span class="comment">//alert("用户名可以是2~5位中文或者6~16位英文和数字的组合");</span></span><br><span class="line">		show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,<span class="string">"用户名可以是2~5位中文或者6~16位英文和数字的组合"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">//校验邮箱信息</span></span><br><span class="line">	<span class="keyword">var</span> empEmail = $(<span class="string">"#email_add_input"</span>).val();</span><br><span class="line">	<span class="keyword">var</span> regEmail = <span class="regexp">/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]&#123;2,6&#125;)$/</span>;</span><br><span class="line">	<span class="keyword">if</span>(!regEmail.test(empEmail))&#123;</span><br><span class="line">		<span class="comment">//alert("邮箱格式不正确");</span></span><br><span class="line">		show_validate_msg(<span class="string">"#email_add_input"</span>,<span class="string">"error"</span>,<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		show_validate_msg(<span class="string">"#email_add_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的<code>show_validate_msg()</code>方法对提示信息进行按需选择<br>修改输入框的边框颜色，需要在输入框的父元素中添加class属性，所以修改前需要先清楚一下样式<br>根据前面<code>validate_add_form()</code>方法传递的参数，设置父元素的颜色属性，还有输入框的下一个标签<code>&lt;span&gt;&lt;/span&gt;</code>标签中的内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示校验结果的提示信息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_validate_msg</span>(<span class="params">ele,status,msg</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//清楚当前元素的校验状态</span></span><br><span class="line">	$(ele).parent().removeClass(<span class="string">"has-success has-error"</span>)</span><br><span class="line">	$(ele).next(<span class="string">"span"</span>).text(<span class="string">""</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(<span class="string">"success"</span> == status)&#123;</span><br><span class="line">		$(ele).parent().addClass(<span class="string">"has-success"</span>);</span><br><span class="line">		$(ele).next(<span class="string">"span"</span>).text(msg);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"error"</span> == status)&#123;</span><br><span class="line">		$(ele).parent().addClass(<span class="string">"has-error"</span>);</span><br><span class="line">		$(ele).next(<span class="string">"span"</span>).text(msg);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>后端校验</strong><br>在输入<code>empName</code>之后，发送一个ajax请求查询数据是否存在，不存在的话添加，存在的话不允许添加<br>在前端校验后面紧跟后端校验判断，判断保存按钮<code>#emp_save_btn</code>的<code>ajax-va</code>属性值是否为<code>error</code>，是的话就返回<code>false</code>退出保存</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3、对用户名是否可用进行校验</span></span><br><span class="line"><span class="keyword">if</span>($(<span class="keyword">this</span>).attr(<span class="string">"ajax-va"</span>)==<span class="string">"error"</span>)&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么在什么时候给保存按钮添加属性呢？在我们输入完<code>empName</code>之后，输入框的<code>change()</code>事件(文本内容改变之后运行)绑定一个方法，发送ajax查询用户是否存在，不存在就给保存按钮的<code>ajax-va</code>属性绑定<code>error</code>  </p>
<p>获取输入框中的值，发送ajax信息，传入参数值<code>empName</code>，根据最后的Msg返回结果判断用户名是否可用，可用给保存按钮自定义属性<code>ajax-va</code>赋值<code>success</code>，否则赋值<code>error</code>，并且调用提示信息方法<code>show_validate_msg()</code>输出提示信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//校验用户名是否可用</span></span><br><span class="line">$(<span class="string">"#empName_add_input"</span>).change(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> empName = <span class="keyword">this</span>.value;</span><br><span class="line">	<span class="comment">//发送ajax请求校验用户名是否存在</span></span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/checkuser"</span>,</span><br><span class="line">		type:<span class="string">"POST"</span>,</span><br><span class="line">		data:<span class="string">"empName="</span>+empName,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(result.code == <span class="number">1</span>)&#123;</span><br><span class="line">				show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"success"</span>,<span class="string">"用户名可用"</span>);</span><br><span class="line">				$(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"success"</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,result.extend.va_msg);</span><br><span class="line">				$(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"error"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>编写<code>EmpController</code>，查询用户名是否可用，指定请求方式<code>method</code>为<code>post</code>请求(和ajax中保持一致)<br>返回Msg对象，使用<code>@RequestParam()</code>传入参数，定义一个和js中一致的正则表达式<code>regx</code>  </p>
<blockquote>
<p>注意：java中的正则表达式没有<code>/正则表达式/</code>中的<code>/</code>  </p>
</blockquote>
<p>使用<code>matches()</code>方法判断用户名的格式，格式错误我们就不查询用户名了，直接调用Msg的请求失败方法，返回失败信息<br>调用<code>empService</code>的<code>checkUser()</code>方法，查询用户是否存在，根据boolean类型返回值，给Msg对象绑定结果  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查用户名是否可用</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> empName</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/checkuser"</span>,method = RequestMethod.POST)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Msg <span class="title">checkUser</span><span class="params">(@RequestParam(<span class="string">"empName"</span>)</span>String empName) </span>&#123;</span><br><span class="line">	<span class="comment">//先判断用户名是否是合法表达式</span></span><br><span class="line">	String regx = <span class="string">"(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)"</span>;</span><br><span class="line">	<span class="keyword">if</span>(!empName.matches(regx)) &#123;</span><br><span class="line">		<span class="keyword">return</span> Msg.fail().add(<span class="string">"va_msg"</span>, <span class="string">"用户名可以是2~5位中文或者6~16位英文和数字的组合"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//数据库用户名重复校验</span></span><br><span class="line">	<span class="keyword">boolean</span> b = empService.checkUser(empName);</span><br><span class="line">	<span class="keyword">if</span>(b) &#123;</span><br><span class="line">		<span class="keyword">return</span> Msg.success();</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> Msg.fail().add(<span class="string">"va_msg"</span>, <span class="string">"用户名已存在"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>empService.checkUser()</code>方法中，可以使用<code>empMapper</code>的<code>countByExample()</code>方法查询用户存不存在，但是它的入参是<code>EmpExample</code>类型，所以还需要new一个<code>EmpExample</code>类型的对象<code>example</code><br>使用<code>example</code>对象的<code>createCriteria()</code>方法给<code>example</code>对象添加查询条件，使用<code>andEmpNameEqualTo()</code>绑定用户名，然后将<code>example</code>传入方法中，最后返回一个long类型的对象，直接返回它是否等于0的布尔值(0表示零条数据，其他数字表示已存在)  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检验用户名是否可用</span></span><br><span class="line"><span class="comment"> * @param empName</span></span><br><span class="line"><span class="comment"> * @return true:代表当前姓名可用，否则不可用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public boolean checkUser(<span class="built_in">String</span> empName) &#123;</span><br><span class="line">	EmpExample example = <span class="keyword">new</span> EmpExample();</span><br><span class="line">	Criteria createCriteria = example.createCriteria();</span><br><span class="line">	createCriteria.andEmpNameEqualTo(empName);</span><br><span class="line">	long count = empMapper.countByExample(example);</span><br><span class="line">	<span class="keyword">return</span> count == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"countByExample"</span> <span class="attr">parameterType</span>=<span class="string">"cn.teaper.www.pojo.EmpExample"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Long"</span>&gt;</span></span><br><span class="line">    select count(*) from emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>表单验证完成了，但是还有一些小问题，例如我们第一次点击新增输入模态框中的内容，在第二次打开模态框之后还在，当我们点击保存之后，他就不会再次发送ajax请求去验证数据，所以我们在每次点击新增按钮的时候清除一下表单数据<code>reset_form(&quot;#empAddModal form&quot;);</code>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增按钮单击事件</span></span><br><span class="line">$(<span class="string">"#emp_add_modal_btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//清空表单样式及内容</span></span><br><span class="line">	reset_form(<span class="string">"#empAddModal form"</span>);</span><br><span class="line">	<span class="comment">//发送ajax请求，查出部门信息，显示在下拉列表中</span></span><br><span class="line">	getDepts();</span><br><span class="line">	<span class="comment">//弹出模态框</span></span><br><span class="line">	$(<span class="string">"#empAddModal"</span>).modal(&#123;</span><br><span class="line">		backdrop:<span class="string">"static"</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>因为jquery没有reset()方法，而该方法是javascript的DOM对象的，所以加<code>[0]</code>取出<code>#empAddModal form</code>的DOM对象，进行重置，并且还要清除表单中所有标签的<code>has-success has-error</code>类样式清除，还有所有class为<code>help-block</code>的标签内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//清空表单样式及内容</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reset_form</span>(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">	$(ele)[<span class="number">0</span>].reset();</span><br><span class="line">	<span class="comment">//清空表单样式</span></span><br><span class="line">	$(ele).find(<span class="string">"*"</span>).removeClass(<span class="string">"has-success has-error"</span>);</span><br><span class="line">	$(ele).find(<span class="string">".help-block"</span>).text(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前端<code>jquery</code>校验完成了，<code>ajax</code>用户名重复校验也完成了，但是，还记得保存按钮<code>#emp_save_btn</code>的<code>ajax-va</code>属性吗？这个好像没有改，如果第一次失败，被设置成<code>error</code>，下次添加就无法保存数据，所以我们还需要进行<strong>JSR303后端校验</strong>  </p>
<p>第一步：<code>pom.xml</code>中导入<code>hibernate-validator</code>组件包  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- JSR303后端校验</span></span><br><span class="line"><span class="comment">hibernate-validator-5.2.4.Final.jar</span></span><br><span class="line"><span class="comment">validation-api-1.1.0.Final.jar</span></span><br><span class="line"><span class="comment">jboss-logging-3.2.1.Final.jar</span></span><br><span class="line"><span class="comment">classmate-1.1.0.jar</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.4.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二步：给<code>Emp.java</code>的bean属性添加验证注解  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pattern</span>(regexp=<span class="string">"(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)"</span>,message=<span class="string">"用户名可以是2~5位中文或者6~16位英文和数字的组合"</span>)</span><br><span class="line"><span class="keyword">private</span> String empName;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@Email或@Pattern</span></span><br><span class="line"><span class="meta">@Pattern</span>(regexp=<span class="string">"^([a-z0-9_\\.-]+)@([\\da-z\\.-]+)\\.([a-z\\.]&#123;2,6&#125;)$"</span>,message=<span class="string">"邮箱格式不正确"</span>)</span><br><span class="line"><span class="keyword">private</span> String email;</span><br></pre></td></tr></table></figure>

<p>第三步：在保存员工方法中，给参数加<code>@Valid</code>注解，并且会有一个返回值<code>BindingResult</code>类型的<code>result</code>，调用<code>result.hasErrors()</code>方法判断是否匹配正则表达式，匹配就保存，不匹配的话还需要返回错误信息到前端，需要创建一个Map对象，将遍历的错误信息封装成Msg对象返回</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工保存</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> emp</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * 1、支持JSR303校验</span></span><br><span class="line"><span class="comment"> * 2、导入Hibernate-Validator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/emp"</span>,method = RequestMethod.POST)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Msg <span class="title">saveEmp</span><span class="params">(@Valid Emp emp,BindingResult result)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(result.hasErrors()) &#123;</span><br><span class="line">		Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">		<span class="comment">//校验失败</span></span><br><span class="line">		List&lt;FieldError&gt; errors = result.getFieldErrors();</span><br><span class="line">		<span class="keyword">for</span> (FieldError fieldError : errors) &#123;</span><br><span class="line">			<span class="comment">//System.out.println("错误的字段名"+fieldError.getField());</span></span><br><span class="line">			<span class="comment">//System.out.println("错误信息"+fieldError.getDefaultMessage());</span></span><br><span class="line">			map.put(fieldError.getField(), fieldError.getDefaultMessage());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Msg.fail().add(<span class="string">"errorField"</span>, map);</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		empService.saveEmp(emp);</span><br><span class="line">		<span class="keyword">return</span> Msg.success();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第四步：前端保存数据，先把<code>jquery</code>格式校验注释掉，保存员工的时候做判断，<code>result.extend.errorField</code>中的<code>email</code>和<code>empName</code>有没有数据，有数据说明有错误，需要设置提示框样式；没数据正常进行保存操作  </p>
<p><span style="color:#ff0000;">成功之后记得把注释的内容解开</span></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//保存员工</span></span><br><span class="line">$(<span class="string">"#emp_save_btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//1、单击模态框中的保存按钮，将数据提交给服务器</span></span><br><span class="line">	<span class="comment">//2、对要提交给服务器的表单数据格式进行校验</span></span><br><span class="line">	<span class="comment">/* if(!validate_add_form())&#123;</span></span><br><span class="line"><span class="comment">		return false;</span></span><br><span class="line"><span class="comment">	&#125;; */</span></span><br><span class="line">	<span class="comment">//3、对用户名是否可用进行校验</span></span><br><span class="line">	<span class="keyword">if</span>($(<span class="keyword">this</span>).attr(<span class="string">"ajax-va"</span>)==<span class="string">"error"</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//4、校验成功发送ajax请求保存员工</span></span><br><span class="line">	<span class="comment">//alert($("#empAddModal form").serialize());</span></span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/emp"</span>,</span><br><span class="line">		type:<span class="string">"POST"</span>,</span><br><span class="line">		data:$(<span class="string">"#empAddModal form"</span>).serialize(),</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//alert(result.msg);</span></span><br><span class="line">			<span class="keyword">if</span>(result.code == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="comment">//员工保存成功</span></span><br><span class="line">				<span class="comment">//1、关闭模态框</span></span><br><span class="line">				$(<span class="string">"#empAddModal"</span>).modal(<span class="string">"hide"</span>);</span><br><span class="line">				<span class="comment">//2、来到末页，显示刚才添加的数据</span></span><br><span class="line">				<span class="comment">//发送ajax请求显示最后一页的数据即可</span></span><br><span class="line">				to_page(totalRecord);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="comment">//校验失败，显示失败信息</span></span><br><span class="line">				<span class="comment">//console.log(result);</span></span><br><span class="line">				<span class="keyword">if</span>(<span class="literal">undefined</span> != result.extend.errorField.email)&#123;</span><br><span class="line">					<span class="comment">//显示邮箱错误信息</span></span><br><span class="line">					show_validate_msg(<span class="string">"#email_add_input"</span>,<span class="string">"error"</span>,result.extend.errorField.email);</span><br><span class="line">					$(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"error"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(<span class="literal">undefined</span> != result.extend.errorField.empName)&#123;</span><br><span class="line">					<span class="comment">//显示员工名字错误信息</span></span><br><span class="line">					show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,result.extend.errorField.empName);</span><br><span class="line">					$(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"error"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="编辑功能"><a href="#编辑功能" class="headerlink" title="编辑功能"></a>编辑功能</h4><p>创建模态框（和新增模态框一样），修改一些标签的<code>id</code>属性名字  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 编辑按钮模态框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empUpdateModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span>员工修改<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 表单 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>用户名(empName)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_update_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>邮箱(email)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_update_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@teaper.cn"</span>&gt;</span></span><br><span class="line">		      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>性别(gender)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">		      	<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">				  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_update_input"</span> <span class="attr">value</span>=<span class="string">"F"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span><br><span class="line">				<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">				  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_update_input"</span> <span class="attr">value</span>=<span class="string">"M"</span>&gt;</span> 女</span><br><span class="line">				<span class="tag">&lt;/<span class="name">label</span>&gt;</span>  </span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>部门名称(deptName)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span><br><span class="line">		      	<span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"fkDeptId"</span> <span class="attr">id</span>=<span class="string">"dept_add_select"</span>&gt;</span></span><br><span class="line">				  <span class="comment">&lt;!-- &lt;option value="fkDeptId"&gt;&lt;/option&gt; --&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">		    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_update_btn"</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在解析员工数据的时候，就给每个按钮添加一个<code>class</code>，编辑按钮叫<code>edit_btn</code>，删除按钮叫<code>del_btn</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> editbtn = $(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>).addClass(<span class="string">"btn btn-primary btn-sm edit_btn"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).addClass(<span class="string">"glyphicon glyphicon-pencil"</span>)).append(<span class="string">"编辑"</span>);</span><br><span class="line"><span class="keyword">var</span> delBtn = $(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>).addClass(<span class="string">"btn btn-danger btn-sm del_btn"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).addClass(<span class="string">"glyphicon glyphicon-trash"</span>)).append(<span class="string">"删除"</span>);</span><br></pre></td></tr></table></figure>

<p>给<strong>编辑按钮绑定单击事件</strong>，可以在解析员工数据的时候绑定，不过太耦合，所以只能在创建按钮之后绑定单击事件<br>这里jquery提供了两个方法，<code>live()</code>适用于<code>jquery 1.7</code>以下版本，我们用的是<code>jquery-3.3.1.min.js</code>，可以使用<code>on()</code>方法  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".edit_btn"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	alert(<span class="string">"编辑"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>确认可以弹出对话框后，发送<code>ajax</code>查询部门列表并显示在下拉列表中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编辑按钮单击事件</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".edit_btn"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//alert("编辑");</span></span><br><span class="line">	<span class="comment">//1、查出员工信息，显示员工信息</span></span><br><span class="line">	<span class="comment">//2、查出部门信息，并显示部门列表</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//发送ajax请求，查出部门信息，显示在下拉列表中</span></span><br><span class="line">	getDepts(<span class="string">"#empUpdateModal select"</span>);</span><br><span class="line">	<span class="comment">//弹出模态框</span></span><br><span class="line">	$(<span class="string">"#empUpdateModal"</span>).modal(&#123;</span><br><span class="line">		backdrop:<span class="string">"static"</span></span><br><span class="line">	&#125;)</span><br><span class="line">	</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>由于之前的查询部门信息的<code>getDepts()</code>方法不是带参数的，而是写死在添加按钮的，这里我们改成传入按钮id参数的方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查出所有部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDepts</span>(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//清空之前下拉列表的值</span></span><br><span class="line">	$(ele).empty();</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/depts"</span>,</span><br><span class="line">		type:<span class="string">"GET"</span>,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//console.log(result);</span></span><br><span class="line">			$(<span class="string">"#dept_add_select"</span>).empty();</span><br><span class="line">			<span class="comment">//显示部门信息在下拉列表中</span></span><br><span class="line">			$.each(result.extend.depts,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">				<span class="keyword">var</span> optionEle = $(<span class="string">"&lt;option&gt;&lt;/option&gt;"</span>).append(<span class="keyword">this</span>.deptName).attr(<span class="string">"value"</span>,<span class="keyword">this</span>.deptId);</span><br><span class="line">				optionEle.appendTo(ele);</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相应的添加用户按钮弹出模态框也要修改修改，这里我就不再累赘了  </p>
<p>弹出模态框后，调用<code>getEmp()</code>方法，<strong>查询并且显示员工</strong>在模态框中  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编辑按钮单击事件</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".edit_btn"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//alert("编辑");</span></span><br><span class="line">	<span class="comment">//1、查出部门信息，并显示部门列表</span></span><br><span class="line">	getDepts(<span class="string">"#empUpdateModal select"</span>);</span><br><span class="line">	<span class="comment">//2、查出员工信息，显示员工信息</span></span><br><span class="line">	getEmp($(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>))</span><br><span class="line">	<span class="comment">//弹出模态框</span></span><br><span class="line">	$(<span class="string">"#empUpdateModal"</span>).modal(&#123;</span><br><span class="line">		backdrop:<span class="string">"static"</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>需要一个员工ID作为参数，由于不知道员工ID，所以，我们在创建编辑和删除按钮的时候就给按钮自定义一个<code>edit-id</code>属性绑定id  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> editBtn = $(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>).addClass(<span class="string">"btn btn-primary btn-sm edit_btn"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).addClass(<span class="string">"glyphicon glyphicon-pencil"</span>)).append(<span class="string">"编辑"</span>);</span><br><span class="line"><span class="comment">//为编辑按钮添加自定义的属性，来表示当前员工的id</span></span><br><span class="line">editBtn.attr(<span class="string">"edit-id"</span>,item.empId);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> delBtn = $(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>).addClass(<span class="string">"btn btn-danger btn-sm del_btn"</span>).append($(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>).addClass(<span class="string">"glyphicon glyphicon-trash"</span>)).append(<span class="string">"删除"</span>);</span><br><span class="line"><span class="comment">//为删除按钮添加自定义的属性，来表示当前员工的id</span></span><br><span class="line">delBtn.attr(<span class="string">"del-id"</span>,item.empId);</span><br></pre></td></tr></table></figure>

<p>发送ajax的GET请求查询员工信息<br><code>input[name=gender]</code>表示所有<code>name</code>属性为<code>gender</code>的输入框，<code>val()</code>方法会自动匹配数组元素  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查出员工信息，显示员工信息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEmp</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+id,</span><br><span class="line">		type:<span class="string">"GET"</span>,</span><br><span class="line">		success: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//console.log(result);</span></span><br><span class="line">			<span class="keyword">var</span> empData = result.extend.emp;</span><br><span class="line">			$(<span class="string">"#empName_update_static"</span>).text(empData.empName);</span><br><span class="line">			$(<span class="string">"#email_update_input"</span>).val(empData.email);</span><br><span class="line">			$(<span class="string">"#empUpdateModal input[name=gender]"</span>).val([empData.gender]);</span><br><span class="line">			$(<span class="string">"#empUpdateModal select"</span>).val([empData.fkDeptId]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>EmpController.java</code>使用<code>@PathVariable()</code>传入<code>GET</code>请求中的<code>id</code>  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//按照员工ID查询员工</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/emp/&#123;id&#125;"</span>,method = RequestMethod.GET)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Msg <span class="title">getEmp</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span>Integer id) </span>&#123;</span><br><span class="line">	Emp emp = empService.getEmp(id);</span><br><span class="line">	<span class="keyword">return</span> Msg.success().add(<span class="string">"emp"</span>,emp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//按照员工ID查询员工</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Emp <span class="title">getEmp</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">	Emp emp = empMapper.selectByPrimaryKey(id);</span><br><span class="line">	<span class="keyword">return</span> emp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByPrimaryKey"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Integer"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span><br><span class="line">    select </span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span> /&gt;</span></span><br><span class="line">    from emp</span><br><span class="line">    where emp_id = #&#123;empId,jdbcType=INTEGER&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>至此，查询和显示完成了，接下来就是点击更新按钮<strong>修改员工信息</strong><br>用户名不让修改，所以我们只需要校验邮箱格式，使用之前的表单数据校验方法里的代码即可，然后改下id名字为<code>#email_update_input</code>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击更新按钮更新员工信息</span></span><br><span class="line">$(<span class="string">"#emp_update_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">//验证邮箱是否合法</span></span><br><span class="line">	<span class="comment">//1、校验邮箱信息</span></span><br><span class="line">	<span class="keyword">var</span> empEmail = $(<span class="string">"#email_update_input"</span>).val();</span><br><span class="line">	<span class="keyword">var</span> regEmail = <span class="regexp">/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]&#123;2,6&#125;)$/</span>;</span><br><span class="line">	<span class="keyword">if</span>(!regEmail.test(empEmail))&#123;</span><br><span class="line">		<span class="comment">//alert("邮箱格式不正确");</span></span><br><span class="line">		show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"error"</span>,<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">//2、发送ajax请求保存员工数据</span></span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">		url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>),</span><br><span class="line">		<span class="comment">//type:"POST",</span></span><br><span class="line">		<span class="comment">//data:$("#empUpdateModal form").serialize()+"&amp;_method=PUT",</span></span><br><span class="line">		type:<span class="string">"PUT"</span>,</span><br><span class="line">		data:$(<span class="string">"#empUpdateModal form"</span>).serialize(),</span><br><span class="line">		success:<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">			<span class="comment">//alert(result.msg);</span></span><br><span class="line">			<span class="comment">//1、关闭对话框</span></span><br><span class="line">			$(<span class="string">"#empUpdateModal"</span>).modal(<span class="string">"hide"</span>);</span><br><span class="line">			<span class="comment">//2、回到本页面</span></span><br><span class="line">			to_page(currentPage);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>发送ajax请求，更新数据，需要发送一个员工id，这里我们可以在弹出模态框之前，给更新按钮绑定一个自定义属性<code>edit-id</code>,这样ajax请求的URL就可以使用<code>$(this).attr(&quot;edit-id&quot;)</code>把值提交  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编辑按钮单击事件</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".edit_btn"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//3、把员工id传递给模态框更新按钮</span></span><br><span class="line">	$(<span class="string">"#emp_update_btn"</span>).attr(<span class="string">"edit-id"</span>,$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//4、弹出模态框</span></span><br><span class="line">	$(<span class="string">"#empUpdateModal"</span>).modal(&#123;</span><br><span class="line">		backdrop:<span class="string">"static"</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>按照Rest风格的URI，后端<code>EmpController.java</code>中就需要发送PUT请求<br><span style="color:#ff0000;">注意：这里的<code>RequestMapping</code>参数不能简单写id，而是要和<code>EmpMapper.xml</code>中的SQL保持一致，写<code>empId</code>，否则SQL会拼接错误</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新员工信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pn</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/emp/&#123;empId&#125;"</span>,method = RequestMethod.PUT)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Msg <span class="title">saveEmp</span><span class="params">(Emp emp)</span> </span>&#123;</span><br><span class="line">	empService.updateEmp(emp);</span><br><span class="line">	<span class="keyword">return</span> Msg.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>EmpService.java</code>实现如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工更新</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> emp</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Emp emp)</span> </span>&#123;</span><br><span class="line">	empMapper.updateByPrimaryKeySelective(emp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是如此一来，前端ajax请求发送方式就有两种方案<br><strong>方案一：</strong> 前端发POST请求，请求数据拼接<code>&amp;_method=PUT</code>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2、发送ajax请求保存员工数据</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">	url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>),</span><br><span class="line">	type:<span class="string">"POST"</span>,</span><br><span class="line">	data:$(<span class="string">"#empUpdateModal form"</span>).serialize()+<span class="string">"&amp;_method=PUT"</span>,</span><br><span class="line">	success:<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">		alert(result.msg);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>方案二(推荐)：</strong> 前端发送PUT请求，表单数据体无法封装成Map，tomcat引发血案  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2、发送ajax请求保存员工数据</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">	url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>),</span><br><span class="line">	type:<span class="string">"PUT"</span>,</span><br><span class="line">	data:$(<span class="string">"#empUpdateModal form"</span>).serialize(),</span><br><span class="line">	success:<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">		alert(result.msg);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>需要在web.xml配置上HttpPutFormContentFilter过滤器  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- REST风格的PUT请求转换过滤器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>HttpPutFormContentFilter</code>会将请求体中的数据解析包装成一个Map，request会被重新包装，request.getParameter()方法会被重写，最后就会从自己封装的Map中取数据，而不是使用Tomcat只能封装的POST请求数据  </p>
<p>接下来就是<strong>关闭模态框和刷新结果</strong>，刷新结果直接调用<code>to_page()</code>方法，不过需要传一个当前页码<code>currentPage</code>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">success:<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//alert(result.msg);</span></span><br><span class="line">	<span class="comment">//1、关闭对话框</span></span><br><span class="line">	$(<span class="string">"#empUpdateModal"</span>).modal(<span class="string">"hide"</span>);</span><br><span class="line">	<span class="comment">//2、回到本页面</span></span><br><span class="line">	to_page(currentPage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当前页码和总记录数一样，直接定义成全局变量，在解析分页信息的时候赋值即可  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> totalRecord,currentPage; <span class="comment">//总记录数,当前页数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解析显示分页信息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build_page_info</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//每次加载前清空分页信息</span></span><br><span class="line">	$(<span class="string">"#page_info_area"</span>).empty();</span><br><span class="line">	$(<span class="string">"#page_info_area"</span>).append(<span class="string">"总"</span>+result.extend.pageInfo.pages+<span class="string">"页 当前第"</span>+result.extend.pageInfo.pageNum+<span class="string">"页 总"</span>+result.extend.pageInfo.total+<span class="string">"条数据"</span>)</span><br><span class="line">	</span><br><span class="line">	totalRecord = result.extend.pageInfo.total;<span class="comment">//保存总记录数</span></span><br><span class="line">	currentPage = result.extend.pageInfo.pageNum;   <span class="comment">//保存当前页码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="迁移至MySQL8-0-数据库"><a href="#迁移至MySQL8-0-数据库" class="headerlink" title="迁移至MySQL8.0+数据库"></a>迁移至MySQL8.0+数据库</h3><p>需要在<code>pom.xml</code>中修改<code>mysql-connector-java.jar</code>的版本为对应的mysql8.0+版本(例如：8.0.16)  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &lt;version&gt;5.1.41&lt;/version&gt; --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在<code>database.properties</code>的<code>jdbc.url</code>上追加<code>&amp;useSSL=true</code>，开启证书验证  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#jdbc.url=jdbc:mysql://127.0.0.1:3306/ssm?useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">jdbc.url=jdbc:mysql://127.0.0.1:3306/ssm?useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf-8&amp;useSSL=<span class="literal">true</span></span><br></pre></td></tr></table></figure>


  </article>
</div>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<div class="container" id="gitalk-container"></div>
<script>
    var gitalk = new Gitalk({
        clientID: '79a82d93fcd761032f45',
        clientSecret: 'b784392d66d81a991565a56598f2d369e71e21ad',
        repo: 'hexoblog',
        owner: 'teaper',
        admin: ['teaper'],
	id: md5(location.pathname),
        distractionFreeMode: true
    })
    gitalk.render('gitalk-container')
</script>




</div>

<div class="footer-wrapper container">
  <footer class="footer clearfix">
    <div class="clearfix">
    <a href="https://www.teaper.dev" class="footer-logo">
      <i class="fa fa-github"></i>
    </a>
    <ul class="footer-social-link">
      <li>© 2019 teaper</li>
      <li><a href="https://www.teaper.dev">Home</a></li>
      
      <li><a href="https://github.com/teaper" rel="external nofollow noopener noreferrer" target="_blank">Github</a></li>
      
      <li><a href="https://www.weibo.com/5806191772" rel="external nofollow noopener noreferrer" target="_blank">Weibo</a></li>
      
      <li><a href="https://twitter.com/TEAPERS" rel="external nofollow noopener noreferrer" target="_blank">Twitter</a></li>
      
    </ul>
    <div class="footer-theme-info" id="hitokoto">
       行是知之始 ❤ 知是行之成
    </div>
    </div>
    
    <div class="footer-pageview">
        <a href="https://info.flagcounter.com/MrmG" rel="external nofollow noopener noreferrer" target="_blank">
          <img src="https://s04.flagcounter.com/count2/MrmG/bg_FFFFFF/txt_6A737D/border_FFFFFF/columns_7/maxflags_14/viewers_3/labels_1/pageviews_1/flags_0/percent_0/">
        </a>
    </div>
    
  </footer>
</div>
<!-- QPlayer音乐播放器 -->
<div id="QPlayer">
<div id="pContent">
	<div id="player">
		<span class="cover"></span>
		<div class="ctrl">
			<div class="musicTag marquee">
				<strong>Title</strong>
				 <span> - </span>
				<span class="artist">Artist</span>
			</div>
			<div class="progress">
				<div class="timer left">0:00</div>
				<div class="contr">
					<div class="rewind icon"></div>
					<div class="playback icon"></div>
					<div class="fastforward icon"></div>
				</div>
				<div class="right">
					<div class="liebiao icon"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="ssBtn">
	        <div class="adf"></div>
    </div>
</div>
<ol id="playlist"></ol>
</div>
<!-- <script src="js/jquery.min.js"></script> -->
<!-- <script src="js/jquery.marquee.min.js"></script> -->
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery.marquee/1.4.0/jquery.marquee.min.js"></script>

<script src="/js/playlist.js"></script>
<script src="/js/player.js"></script>
<script>
function bgChange(){
	var lis= $('.lib');
	for(var i=0; i<lis.length; i+=2)
	lis[i].style.background = 'rgba(246, 246, 246, 0.5)';
	
	$(".avatar").hover(function(){
		$(".avatar").attr({
		"src" : "http://ww1.sinaimg.cn/large/006kWbIoly1g763f4h9w5j30np0np40j.jpg"
		});
	},function(){
		$(".avatar").attr({
		"src" : "https://i.loli.net/2019/06/04/5cf683cea837456459.jpeg"
		});
	});
}
window.onload = bgChange;
</script>

<!-- Live2D血小板 -->
<div id="landlord">
    <div class="message" style="opacity:0"></div>
    <canvas id="live2d" width="560" height="500" class="live2d"></canvas>
    <!-- 省略隐藏按钮 -->
</div>

<!-- 鼠标单击爆炸区域 -->
<canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:1031;pointer-events:none;"></canvas>

<script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript">
    var message_Path = '/live2d/'
    var home_Path = 'https://www.teaper.dev/'
</script>
<script type="text/javascript" src="/live2d/js/live2d.js"></script>
<script type="text/javascript" src="/live2d/js/message.js"></script>
<script type="text/javascript">
    loadlive2d("live2d", "/live2d/model/xiaoban/model.json");
</script>

<!-- 打字泡沫 -->
<script type="text/javascript" src="/js/activate-power-mode.js"></script>
<script>
    POWERMODE.colorful = true;  
    POWERMODE.shake = false;    
    document.body.addEventListener('input', POWERMODE);
</script>

<!-- 引入一言 -->
<script src="https://cdn.jsdelivr.net/npm/bluebird@3/js/browser/bluebird.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@2.0.3/fetch.min.js"></script>
<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<!-- <script src="/js/hitokoto.js"></script> -->

<!-- 粒子特效 -->
<!-- <script src="/js/canvas-nest.min.js"></script> -->

<!-- 鼠标单击爱心特效 -->
<script src="/js/mouse.js"></script>
<!-- 鼠标单击爆炸特效 -->
<script src="/js/anime.min.js"></script>
<script src="/js/fireworks.js"></script>

<!-- 站内搜索 -->
<script src="/js/search.js"></script>



<script>
  (function() {
    var cx = '014633199185561276043:bpv9wnr4qhc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>



<script src="/js/main.js"></script>

</body>
</html>
